
; Var(0)  = 
; Var(1)  = 
; Var(2)  = 技強弱
; Var(3)  = 
; Var(4)  = キャンセルフラグ
; Var(5)  = 3cヒットフラグ
; Var(6)  = x
; Var(7)  = y
; Var(8)  = 空D制限
; Var(9)  = スタンド出現フラグ
;
; Var(10) = 敗北演出設定
; Var(11) = 勝利演出
; Var(12) = 試合開始フラグ
; Var(13) = ヒット数
; Var(14) = 投げ補正
; Var(15) = ギターヒット音 
; Var(16) = 
; Var(17) = 
; Var(18) = 
; Var(19) = movehitの代わり
;
; Var(20) = 便利var
; Var(21) = 崩れ落ち制限
; Var(22) = 電力no
; Var(23) = 
; Var(24) = 
; Var(25) = 
; Var(26) = 
; Var(27) = 
; Var(28) = 
; Var(29) = 
;
; Var(30) = 
; Var(31) = 
; Var(32) = 
; Var(33) = デバッグ用技制御(AI用)
; Var(34) = 
; Var(35) = 
; Var(36) = 
; Var(37) = 
; Var(38) = 
; Var(39) = 
;
; var(40) = 
; Var(41) = 
; Var(42) = 
; Var(43) = 
; Var(44) = 
; Var(45) = 
; Var(46) = 
; Var(47) = 
; Var(48) = 生死判別
; Var(49) = 
;
; Var(50) = 
; Var(51) = 
; Var(52) = 
; Var(53) = 
; Var(54) = 
; Var(55) = 
; Var(56) = 
; Var(57) = intro
; Var(58) = 電撃ゲージ
; Var(59) = AI判定(AI用)
;
;FVar(0)  = 
;FVar(1)  = 
;FVar(2)  = 
;FVar(3)  = 
;FVar(4)  = 
;FVar(5)  = 
;FVar(6)  = 
;FVar(7)  = 
;FVar(8)  = 
;FVar(9)  = 
;
;FVar(10) = コンボ補正
;FVar(11) = 
;FVar(12) = 
;FVar(13) = 
;FVar(14) = 
;FVar(15) = 
;FVar(16) = 
;FVar(17) = 
;FVar(18) = 
;FVar(19) = 
;
;FVar(20) = 浮き補正
;FVar(21) = intro
;FVar(22) = 
;FVar(23) = 
;FVar(24) = 
;FVar(25) = 
;FVar(26) = 
;FVar(27) = 
;FVar(28) = 
;FVar(29) = 
;
;FVar(30) = 
;FVar(31) = 
;FVar(32) = 
;FVar(33) = 
;FVar(34) = 
;FVar(35) = 
;FVar(36) = 
;FVar(37) = 
;FVar(38) = 
;FVar(39) = 

;---------------------------------------------------------------------------
; 基本データ
;---------------------------------------------------------------------------
[Data]
life              = 1000   ;ライフ（体力ゲージ）最大値
power             = 5000   ;パワーゲージ最大値（オプション・デフォルトは3000=Lv.3）
attack            = 100    ;攻撃力（デフォルトは１００％）
defence           = 100    ;防御力（デフォルトは１００％）
fall.defence_up   = 50     ;横に倒れている時に一時的に加える防御力（％）
liedown.time      = 30     ;横に倒れている時間（フレーム）
airjuggle         = 15     ;ジャグルポイント限界値（「小ネタ.txt」参照）
sparkno           = 2      ;デフォルトのヒットスパーク（fightfxから）
guard.sparkno     = 40     ;デフォルトのガードスパーク（fightfxから）
KO.echo           = 0      ;ＫＯ時の音声（11,0）にエコーを掛けるか否か（0=掛けない,1=掛ける）
volume            = 255    ;キャラの標準の音量（最小-255・最大255）
IntPersistIndex   = 57     ;次のラウンドへ持ち越せる「Var」のアドレスの範囲を決める（※１）
FloatPersistIndex = 40     ;次のラウンドへ持ち越せる「FVar」のアドレスの範囲を決める（※１）

;---------------------------------------------------------------------------
; サイズ
;---------------------------------------------------------------------------
[Size]
xscale           = .45       ;キャラの横の大きさ（絶対値・float）
yscale           = .6       ;キャラの縦の大きさ（絶対値・float）
ground.back      = 20      ;地上にいる時の「後方の物理的な幅」
ground.front     = 20      ;地上にいる時の「前方の物理的な幅」
air.back         = 10      ;空中にいる時の「後方の物理的な幅」
air.front        = 10      ;空中にいる時の「前方の物理的な幅」
height           = 60      ;キャラの物理的な高さ（高いほど相手は飛び越しにくくなる）
attack.dist      = 160     ;相手がガード態勢に入る最低の距離
proj.attack.dist = 90      ;自分の「Projectile」に対して相手がガード態勢に入る最低の距離
proj.doscale     = 0       ;xscaleとyscaleを「Projectile」にも影響させるか否か（0=させない・1=させる）
head.pos         = -5,-100  ;キャラの標準の頭の座標（Bind系で適用される）
mid.pos          = -5,-60  ;キャラの標準の体中心の座標（Bind系で適用される）
shadowoffset     = 2       ;影のＹ軸方向の位置座標
draw.offset      = 0,0     ;キャラの表示座標（Ｘ軸,Ｙ軸）

;---------------------------------------------------------------------------
; 移動速度
;---------------------------------------------------------------------------
[Velocity]
walk.fwd     = 2.2         ;前進速度（Ｘ軸・[Statedef 20]に適用される）
walk.back    = -2.0        ;後退速度（Ｘ軸・[Statedef 20]に適用される）
run.fwd      = 5.5,-4       ;前方に走る速度（Ｘ軸,Ｙ軸・[Statedef 100]に適用される）
run.back     = -5.7, 0   ;後方に走る速度（Ｘ軸,Ｙ軸・[Statedef 105]に適用される）
jump.neu     = 0,-9.5      ;垂直ジャンプの速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
jump.back    = -3       ;後方ジャンプの速度（Ｘ軸・[Statedef 40]に適用される）
jump.fwd     = 3         ;前方ジャンプの速度（Ｘ軸・[Statedef 40]に適用される）
runjump.back = -3,-8.5  ;後方に走ってからのジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
runjump.fwd  = 3,-8.5      ;前方に走ってからのジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
airjump.neu  = 0,-8.1      ;空中垂直ジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 45]に適用される）
airjump.back = -2.55       ;空中後方ジャンプ速度（Ｘ軸・[Statedef 45]に適用される）
airjump.fwd  = 2.5         ;空中前方ジャンプ速度（Ｘ軸・[Statedef 45]に適用される）

;---------------------------------------------------------------------------
; 運動関係
;---------------------------------------------------------------------------
[Movement]
airjump.num     = 0        ;空中ジャンプが出来る回数
airjump.height  = 35       ;空中ジャンプが出来る最低の高度（Ｙ軸）
yaccel          = .5      ;Ｙ軸加速度（重力）
stand.friction  = .85      ;立っている時の摩擦係数（ステートのPhysicsが「S」の時）
crouch.friction = .82      ;しゃがんでいる時の摩擦係数（ステートのPhysicsが「C」の時）

;===========================================================================
; 基本行動
;===========================================================================


;---------------------------------------------------------------------------
; Jump Land
[Statedef 52]
type    = S
physics = S
ctrl = 0
anim = IfElse(var(8), 701, 47)

[State 52, 2]
type = playsnd
trigger1 = Time = 0
value = 52,0

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 3]
type = CtrlSet
trigger1 = !var(8)
trigger1 = Time = 3
value = 1

[State 52, ]
type = assertspecial
trigger1 = var(8)
flag = nostandguard
flag2 = nocrouchguard
flag3 = noairguard

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------------------------------------
; Jump Land(Spe)
[Statedef 2252]
type    = S
physics = S
ctrl = 0
anim = 48
facep2 = 1

[State 52, 2]
type = playsnd
trigger1 = Time = 0
value = 52,0

[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, ガード不能]
type = assertspecial
trigger1 = !ctrl && ((prevstateno = [600,699]) || (prevstateno = [901,906]))
trigger1 = AnimTime < 0
flag = nostandguard
flag2 = nocrouchguard
flag3 = noairguard

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; SGUARDHIT (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0

[State -3, GetHurt Sound]
type = PlaySnd
triggerall = Random < 200
triggerall = Alive = 1
triggerall = Time = 1
trigger1 = prevStateNo != 150 || prevStateNo != 151 || prevStateNo != 152
value = 150,0+(random%2)
channel = 10
persistent = 0

[State 150, 1]
type = ChangeAnim
trigger1 = 1
value = 150

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(command = "holddown")

[State 150, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 150, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

[State 150, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 3

;---------------------------------------------------------------------------
; CGUARDHIT (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0

[State -3, GetHurt Sound]
type = PlaySnd
triggerall = Random < 200
triggerall = Alive = 1
triggerall = Time = 1
trigger1 = prevStateNo != 150 || prevStateNo != 151 || prevStateNo != 152
value = 150,0+(random%2)
channel = 10
persistent = 0

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = 151

[State 152, 3]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(command = "holddown")

[State 152, Hi to Lo]
type = StateTypeSet
trigger1 = statetype = S && command = "holddown"
statetype = C
physics = C

[State 152, Lo to Hi]
type = StateTypeSet
trigger1 = statetype = C && command != "holddown"
statetype = S
physics = S

[State 152, 4]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; AGUARDHIT (shaking)
[Statedef 154]
type    = A
movetype= H
physics = N
velset = 0,0

[State -3, GetHurt Sound]
type = PlaySnd
triggerall = Random < 200
triggerall = Alive = 1
triggerall = Time = 1
trigger1 = prevStateNo != 150 || prevStateNo != 151 || prevStateNo != 152
value = 150,0+(random%2)
channel = 10
persistent = 0

[State 154, 1]
type = ChangeAnim
trigger1 = 1
value = 152

[State 154, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 155 ;AGUARDHIT2

[State 154, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;===========================================================================
;HITG_SHAKE
[Statedef 5000]
type = S
movetype = H
physics = N
ctrl = 0
velset = 0,0

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype)

[State 0, state]
type = statetypeset
trigger1 = !time
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = pos y != 0
statetype = A

[State 0, end]
type = changestate
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 5001

[State 0, end]
type = changestate
trigger1 = HitShakeOver
value = 5030

[State 0, ffb L]
type = forcefeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
waveform = square
time = 6
persistent = 0

[State 0, ffb M]
type = forcefeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
waveform = square
time = 8
ampl = 110,-1,-.3
persistent = 0

[State 0, ffb H]
type = forcefeedback
trigger1 = anim = 5002
trigger2 = anim = 5012
trigger3 = anim = 5030
waveform = square
time = 15
ampl = 140
persistent = 0

;---------------------------------------------------------------------------
;HITC_SHAKE
[Statedef 5010]
type = C
movetype = H
physics = N
velset = 0,0

[State 0, state]
type = statetypeset
triggerall = !time
trigger1 = prevstateno = [5010,5011]
statetype = S

[State 0, anim]
type = changeanim
trigger1 = (anim = [5020,5022])
trigger1 = !animtime
value = anim
elem = 2

[State 0, end]
type = changestate
triggerall = !time
trigger1 = prevstateno = [5010,5011]
value = 5000

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = GetHitVar(animtype) != [3,5]
value = 5020 + GetHitVar(animtype)

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype)

[State 0, anim]
type = changeanim
trigger1 = animelem = 2
value = anim
elem = 2

[State 0, state]
type = statetypeset
trigger1 = !time
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = pos y != 0
statetype = A

[State 0, end]
type = changestate
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 5011

[State 0, end]
type = changestate
trigger1 = HitShakeOver
value = 5030

[State 0, ffb L]
type = forcefeedback
trigger1 = anim = 5020
waveform = square
time = 6
persistent = 0

[State 0, ffb M]
type = forcefeedback
trigger1 = anim = 5021
waveform = square
time = 8
ampl = 110,-1,-.3
persistent = 0

[State 0, ffb H]
type = forcefeedback
trigger1 = anim = 5022
waveform = square
time = 15
ampl = 140
persistent = 0

;---------------------------------------------------------------------------
; HIT_GETUP
[Statedef 5120]
type    = L
movetype= I
physics = N
velset = 0,-6

[State -2]
type = veladd
trigger1 = 1
y = .4

[State -2]
type = Angledraw
trigger1 = 1

[State -2]
type = Angleset
trigger1 = !time
value = 0

[State -2]
type = AngleAdd
trigger1 = 1
value = -50
[State -2]
type = Anglemul
trigger1 = 1
value = .905


[State 5120, 3]
type = playsnd
trigger1 = !time
value = 5120,0+(random%2)
channel = 0

[State 5120, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5111,5119]
trigger2 = !SelfAnimExist(5120 + (anim % 10))
value = 5120

[State 5120, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5111,5119]
trigger1 = SelfAnimExist(5120 + (anim % 10))
value = 5120 + (anim % 10)

[State 5120, 2]
type = VelSet
trigger1 = Time = 0
x = 0

[State 5120, 3]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5120, 4]
type = HitFallSet
trigger1 = time = 28
value = 1

[State 5120, 5] ;Can't be thrown right after getting up
type = NotHitBy
trigger1 = time = 28
value = , NT,ST,HT
time = 12

[State 5120, 6] ;Can't be hit right after getting up (short time)
type = NotHitBy
trigger1 = time = 28
value2 = SCA
time = 3

[State 5120, 7]
type = offset
trigger1 = !(time > 28)
y = -40

[State 5120, 7]
type = posset
trigger1 = time = 28
y = 0

[State -2]
type = Angledraw
trigger1 = time = 28
value = 0


[State 5120, 3]
type = playsnd
trigger1 = time = 28
value = 52,0
presistent = 0

[State 5120, 7]
type = ChangeState
trigger1 = time = 28
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HIT_LIEDEAD
[Statedef 5150]
type    = L
movetype= H
physics = N
sprpriority = -3

[State 5150, 1] ;Normal anim
type = ChangeAnim
triggerall = Time = 0
triggerall = SelfAnimExist(5140)
trigger1 = (anim != [5111,5119]) && (anim != [5171,5179])
trigger2 = !SelfAnimExist(5140 + (anim % 10))
value = 5140

[State 5150, 3] ;Hit up type anim
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (anim = [5111,5119]) || (anim = [5171,5179])
trigger1 = SelfAnimExist(5140 + (anim % 10))
value = 5140 + (anim % 10)

[State 5150, 4] ;Match over anim
type = ChangeAnim
persistent = 0
;trigger1 = Time = 0
trigger1 = MatchOver = 1
trigger1 = Anim = [5140,5149]
trigger1 = SelfAnimExist(anim+10)
value = anim+10

[State 5150, 5] ;Switch to 5110 if liedead anim does not exist
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != [5140,5159]
trigger1 = Anim != [5110,5119]
value = 5110

[State 5150, 6] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5150, 7] ;Friction
type = VelSet
trigger1 = Vel x < .05
persistent = 0
x = 0

[State 5150, 8]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Air get-hit (fall recovery on ground; still falling)
[Statedef 5200]
type    = A
movetype= H
physics = N

[State 5200, 1] ;Change anim if done with transition
type = ChangeAnim
trigger1 = Anim = 5035
trigger1 = AnimTime = 0
value = 5050

[State 5200, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5200, 3]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= Const(movement.air.gethit.groundrecover.groundlevel)
value = 5201

;---------------------------------------------------------------------------
; Air get-hit (fall recovery on ground)
[Statedef 5201]
type = S
movetype = I
physics = N
anim = 5200

[State -2, Voice]
type = PlaySnd
trigger1 = !time
value = 5210, 0 + (random%2)
channel = 0

[State 5201, 1] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < Const720p(-20)

[State 0, vel]
type = velset
trigger1 = !time
x = -4
y = 0

[State 0, vel]
type = velmul
trigger1 = 1
x = .95

[State 5201, 3]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 3

[State 5201, 5] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5201, 6]
type = Explod
trigger1 = Time = 0
anim = F60
postype = none
pos = pos x + camerapos x, (pos y) - floor(vel y)
facing = facing
sprpriority = -10

[State 5201, 5] ;Blink white
type = Changestate
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HIT_AIRFALLRECOVER
[Statedef 5210]
type    = A
movetype= I
physics = N
anim = 5210
ctrl = 0
velset = 0,0

[State -2, Voice]
type = PlaySnd
trigger1 = !time
value = 5210,0+(random%2)
channel = 0

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5210, 1]
type = PosFreeze
trigger1 = Time = 0
value = 4

[State 5210, 2] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -20

[State 5210, 3]
type = NotHitBy
trigger1 = Time = 0
value = SCA
time = 15

[State 5210, 1]
type = Velset
trigger1 = Time = 4
y = -6

[State 5210, 2] ;Go fwd
type = VelSet
trigger1 = Time = 4
trigger1 = Command = "holdfwd"
x = 3

[State 5210, 2] ;Go back
type = VelSet
trigger1 = Time = 4
trigger1 = Command = "holdback"
x = -3

[State 5210, 4]
type = CtrlSet
trigger1 = Time = 4
value = 1

[State 5210, 5]
type = VelAdd
trigger1 = 1
y = .45

[State 5210, 5] ;Land on ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMP_LAND
ctrl = 1

;commonここまで
;---------------------------------------------------------------------------
;タイムオーバー（負けた時）
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 903, 時間停止]
type = playsnd
trigger1 = time = 8
value = 3005,1
channel = 0

[State 170, 無敵]
type = NotHitBy
trigger1 = 1 ;トリガーを何も書かず「1」にする事により、『無条件で常に実行させる命令』になる。
value = SCA
time = 1

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;勝利ポーズ分岐（common1.cnsには無いけど、これもコモンステート）
[Statedef 180]
type = S

[State 180, ステート変更]
type = ChangeState
trigger1 = Time = 0
value = 181

;---------------------------------------------------------------------------
;勝利1
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[State -2, Voice]
type = PlaySnd
trigger1 = !matchover
trigger1 = !time
value = 180,random%2
channel = 0

[State 903, 時間停止]
type = playsnd
triggerall = matchover
trigger1 = var(57) = 1;承太郎
trigger1 = time = 30
value = 1910,random%2
channel = 0

[State 903, 時間停止]
type = playsnd
triggerall = matchover
trigger1 = var(57) = 2;仗助
trigger1 = time = 30
value = 1920,0
channel = 0

[State 903, 時間停止]
type = playsnd
triggerall = matchover
trigger1 = var(57) = 3;露伴
trigger1 = time = 30
value = 1930,random%2
channel = 0

[State 903, 時間停止]
type = playsnd
triggerall = matchover
trigger1 = var(57) = 4;こういち
trigger1 = time = 30
value = 1940,0
channel = 0

[State 903, 時間停止]
type = playsnd
triggerall = matchover
trigger1 = var(57) = 5;ジョセフ(老)
trigger1 = time = 30
value = 1950,0
channel = 0

[State 903, 時間停止]
type = playsnd
triggerall = matchover
trigger1 = var(57) = 6;億泰
trigger1 = time = 30
value = 1960,0
channel = 0

[State -2, Voice]
type = PlaySnd
trigger1 = matchover
trigger1 = var(57) = 0
trigger1 = !time
value = 181,random%3
channel = 0

[State 181, 1]
type = AssertSpecial
trigger1 = Time = [0,240+(matchover)*240]
flag = RoundNotOver

[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
; PREINTRO
[Statedef 190]
type = S
ctrl = 0
anim = 9999

[State 0, anim]
type = palfx
trigger1 = 1
mul = -128,-128,-128
time = 1

[State 承太郎]
type = varset
triggerall = !time
trigger1 = p2name = "Jotaro" || p4name = "Jotaro"
trigger2 = p2name = "Jotaro Kujo" || p4name = "Jotaro Kujo"
var(57) = 1

[State 仗助]
type = varset
triggerall = !time
trigger1 = p2name = "Josuke" || p4name = "Josuke"
trigger2 = p2name = "Josuke higashikata" || p4name = "Josuke higashikata"
var(57) = 2

[State 露伴]
type = varset
triggerall = !time
trigger1 = p2name = "rohan" || p4name = "rohan"
var(57) = 3

[State こういち]
type = varset
triggerall = !time
trigger1 = p2name = "hirose koiti" || p4name = "hirose koiti"
var(57) = 4

[State ジョセフ]
type = varset
triggerall = !time
trigger1 = p2name = "joseph" || p4name = "joseph"
trigger2 = p2name = "joseph joestar" || p4name = "joseph joestar"
var(57) = 5

[State おくやす]
type = varset
triggerall = !time
trigger1 = p2name = "Okuyasu" || p4name = "Okuyasu"
trigger2 = p2name = "Okuyasu" || p4name = "Okuyasu"
var(57) = 6

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 0, end]
type = changestate
trigger1 = var(57) != 3 && var(57) != 6
trigger1 = time > 0
trigger2 = p2stateno = 0
value = 191

[State 0, end]
type = changestate
trigger1 = var(57) = 6
value = 196

;---------------------------------------------------------------------------
; PREINTRO
[Statedef 191]
type = S
ctrl = 0
anim = 190

[State 100, 1]
type = playsnd
trigger1 = animelemtime(2) = 1
value = 10,1
channel = 1

[State 速度制限]
type = screenbound
trigger1 = 1
value = 0

[State 速度制限]
type = varset
trigger1 = !time
fvar(21) = pos x*facing

[State 速度制限]
type = posadd
trigger1 = time = 30
X = fvar(21) - 55
y = -30

[State 速度制限]
type = varset
trigger1 = time = 30
fvar(22) = pos x*facing

[State 速度制限]
type = velset
trigger1 = time = 30
X = 1.5
y = .18

[State 追尾加速度]
type = veladd
triggerall = facing = 1
trigger1 = time <= 200
trigger1 = time >= 30
trigger1 = pos x - fvar(22) < 120 && vel X > -7.5
X = 0.26
[State 追尾加速度]
type = veladd
triggerall = facing = 1
trigger1 = time <= 200
trigger1 = time >= 30
trigger1 = pos x - fvar(22) >= 120 && vel X < 14.5
X = -0.18

[State 追尾加速度]
type = veladd
triggerall = facing = -1
trigger1 = time <= 200
trigger1 = time >= 30
trigger1 = pos x - fvar(22) >= 270 && vel X > -7.5
X = 0.26
[State 追尾加速度]
type = veladd
triggerall = facing = -1
trigger1 = time <= 200
trigger1 = time >= 30
trigger1 = pos x - fvar(22) < 270 && vel X < 14.5
X = -0.18


[State 速度制限]
type = velset
;triggerall = facing = 1
trigger1 = time <= 200
trigger1 = abs(vel X) > 1.6
X = ifelse(vel X>0,1.6,-1.6)

[State 速度制限]
type = velset
trigger1 = time = 200
X = 0
y = 0

[State 速度制限]
type = posset
trigger1 = time = 200
X = fvar(21)*facing
y = 0

[State 0, anim]
type = angledraw
trigger1 = animelemtime(2) >= 0
trigger1 = time <= 200
scale = 0.05+(time-30)*0.005,0.05+(time-30)*0.005

[State 0, anim]
type = palfx
trigger1 = animelemtime(2) >= 0
trigger1 = time <= 200
mul = -128+(time-30)*2,-128+(time-30)*2,-128+(time-30)*2
time = 1

[State 903, 時間停止]
type = playsnd
trigger1 = var(57) = 1;承太郎
trigger1 = time = 30
value = 191,0
channel = 0

[State 903, 時間停止]
type = playsnd
trigger1 = var(57) = 2;仗助
trigger1 = time = 30
value = 192,random%3
channel = 0

[State 903, 時間停止]
type = playsnd
trigger1 = var(57) = 3;露伴
trigger1 = time = 30
value = 193,random%2
channel = 0

[State 903, 時間停止]
type = playsnd
trigger1 = var(57) = 4;こういち
trigger1 = time = 30
value = 194,0
channel = 0

[State 903, 時間停止]
type = playsnd
trigger1 = var(57) = 5;ジョセフ
trigger1 = time = 30
value = 195,0
channel = 0

[State 903, 時間停止]
type = playsnd
trigger1 = !var(57)
trigger1 = time = 30
value = 190,random%5
channel = 0

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 0, end]
type = changeanim
trigger1 = time = 200
value = 0

[State 0, end]
type = changestate
trigger1 = time > 260
value = 0

;---------------------------------------------------------------------------
; PREINTRO
[Statedef 196]
type = S
ctrl = 0
anim = 196

[State 100, 1]
type = playsnd
trigger1 = time = 30
value = 196, 0
channel = 0

[State 速度制限]
type = screenbound
trigger1 = 1
value = 0

[State 0, end]
type = changeanim
trigger1 = time = 100
value = 20

[State 速度制限]
type = posadd
trigger1 = time = [100, 155]
x = 1

[State 903, 時間停止]
type = playsnd
trigger1 = time = 155
value = 196,1
channel = 0

[State 0, end]
type = changeanim
trigger1 = time = 155
value = 105

[State 速度制限]
type = posadd
trigger1 = time = [155, 165]
x = -5

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 0, end]
type = changeanim
trigger1 = anim = 105 && !animtime
value = 0

[State 0, end]
type = changestate
trigger1 = time > 260
value = 0

;---------------------------------------------------------------------------
;挑発
[Statedef 195]
type = S
movetype = I
physics = S
ctrl = 0
anim = 195
velset = 0,0
sprpriority = 1

[State 903, ]
type = varset
trigger1 = time = 0
var(20) = 5

[State 903, ]
type = varadd
trigger1 = life = lifeMax && power = powermax
trigger1 = command = "start"
var(20) = -1

;debug
[State 903, ]
type = varset
trigger1 = var(20) = 0
var(58) = 50
[State 903, ]
type = lifeset
trigger1 = var(20) = 0
value = 0
[State 903, ]
type = ctrlset
trigger1 = var(20) = 0
value = 1


[State 903, 時間停止]
type = playsnd
trigger1 = time = 1
value = 199,0
channel = 0

[State 195, ステート変更]
type = ChangeState
trigger1 = time > 60
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ライトハンド奏法
[Statedef 300]
type = S
movetype = I
physics = N
ctrl = 0
anim = 300
velset = 0,0
sprpriority = 1

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4) = 0

[State 0, explod]
type = explod
trigger1 = time = 0
anim = 308
id = 308
facing = 1
postype = back
pos = 0, 160
sprpriority = -5
ownpal = 1
removeongethit = 1
bindtime = -1
scale = .5,.5
ignorehitpause = 0
removetime = 240

[State 0, explod]
type = explod
trigger1 = time = 0
anim = 305
id = 305
facing = 1
postype = p1
pos = -5,-70
sprpriority = 2
ownpal = 1
removeongethit = 1
bindtime = -1
scale = .5,.5
ignorehitpause = 0
removetime = 150

[State 903, 時間停止]
type = removeexplod
trigger1 = time = 150
id = 305

[State 0, explod]
type = explod
trigger1 = time = 150
anim = 306
id = 305
facing = 1
postype = p1
pos = -5, -60
sprpriority = 2
ownpal = 1
removeongethit = 1
bindtime = -1
removetime = 90
scale = .5,.5
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = time = 222
anim = 309
id = 309
facing = 1
postype = back
pos = 60, 30
sprpriority = -8
ownpal = 1
removeongethit = 1
bindtime = -1
removetime = 62
scale = 2, 2
vel = 0, -0.5
ignorehitpause = 0

[State 903, 時間停止]
type = modifyexplod
trigger1 = time < 200
angle = 0 + floor(time * 0.25)
id = 305

[State 903, 時間停止]
type = modifyexplod
trigger1 = time < 18
trans = AddAlpha
alpha = 256, 255 - (time * 14)
id = 308
[State 903, 時間停止]
type = modifyexplod
trigger1 = time = [18, 222]
trans = None
id = 308
[State 903, 時間停止]
type = modifyexplod
trigger1 = time > 222
trans = AddAlpha
alpha = 256 - ((time - 222) * 14), 0 + ((time - 222) * 14)
id = 308
[State 903, 時間停止]
type = modifyexplod
trigger1 = time > 222
trans = AddAlpha
alpha = 256 - ((time - 222) * 15), 0 + ((time - 222) * 15)
id = 309

[State 903, 時間停止]
type = playsnd
trigger1 = time = 1
value = 3010, 0
channel = 5

[State 903, 時間停止]
type = playsnd
trigger1 = time = 1
value = 300, 0
channel = 0
[State 903, 時間停止]
type = playsnd
trigger1 = time = 222
value = 300, 1
channel = 0

[State 903, 時間停止]
type = varset
trigger1 = roundstate = 2
trigger1 = time = 222
var(58) = 49
[State 903, 時間停止]
type = poweradd
trigger1 = roundstate = 2
trigger1 = time = 222
value = 1000

[State 195, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===========================================================================
; 通常攻撃技
;===========================================================================
;立ちA
[Statedef 200]
type    = S
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 200
sprpriority = 1

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(2) >= 0
var(4)= 1
ignorehitpause = 1

[State 200, 物理的なキャラの幅]
type = Width
trigger1 = (AnimElemTime (2) >= 0) && (AnimElemTime (4) < 0)
value = 10,0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = time = 1
value = 200,0
channel = 0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 3,0
channel = 1

[State 200, ヒット定義]
type = HitDef
triggerall = (!movecontact && !movereversed)
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
attr = S, NA
animtype  = Light
damage    = ceil(25*fVar(10)),0
guardflag = MA
pausetime = 11,11
sparkno = s6000
guard.sparkno = s6040
sparkxy = -10,-62
hitsound   = s5,0
guardsound = s10,0
priority = 4, Hit
ground.type = High
ground.slidetime = 12
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -4
air.velocity = -4,-3.8 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 40,0
givepower = 20,0
fall = 0
air.fall = ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
sprpriority = 1

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;立ちA(S)
[Statedef 205]
type    = S
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 205
sprpriority = 2

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, anim]
type = changeanim
trigger1 = root,time = 1
trigger1 = anim = 205
value = 205

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 30,0

[State 0, anim]
type = changeanim
trigger1 = root,var(19)
trigger1 = animelem = 3
value = anim
elem = 2

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = !(root,stateno = 200)
trigger1 = (root,stateno = [200,220]) || (root,stateno = 410)
value = root,stateno + 5

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = (root,stateno = [1000,1100]) || (root,stateno = 2000||root,stateno = 2100||root,stateno = 2200) || (root,stateno = 3000)
value = root,stateno + 50

[State 0, explod]
type = explod
trigger1 = animtime = -1
trigger2 = root,stateno != 200
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
anim = 7201
id = 7201
pos = 0,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = animtime = -1
trigger2 = root,stateno != 200
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
anim = 8201
id = 8201
pos = 0,-40
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0
[State 0, snd]
type = playsnd
trigger1 = animtime = -1
trigger2 = root,stateno != 200
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
value = 12,1

[State 0, end]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno != 200 && root,stateno != 420 && root,stateno != 1200
value = 10000

;---------------------------------------------------------------------------
;立ちB
[Statedef 210]
type    = S
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 210
sprpriority = 1

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(3) >= 0
var(4)= 1
ignorehitpause = 1

[State 200, 物理的なキャラの幅]
type = Width
trigger1 = (AnimElemTime (2) >= 0) && (AnimElemTime (4) < 0)
value = 10,0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = time = 1
value = 210,0+(random%2)
channel = 0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 3
value = 3,1
channel = 1

[State 200, ヒット定義]
type = HitDef
triggerall = (!movecontact && !movereversed)
trigger1 = AnimElem = 3
trigger2 = AnimElem = 4
trigger3 = AnimElem = 5
attr = S, NA
animtype  = medium
damage    = ceil(36*fVar(10)),0
guardflag = MA
pausetime = 11,11
sparkno = s6001
guard.sparkno = s6040
sparkxy = -10,-52
hitsound   = s5,1
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 16
guard.slidetime = 14
ground.hittime  = 14
ground.velocity = -4
air.velocity = -4, -3.8 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 50,0
givepower = 25,0
fall = 0
air.fall = ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
sprpriority = 1

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;立ちB(S)
[Statedef 215]
type    = S
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 215
sprpriority = 2

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 30,0

[State 0, anim]
type = changeanim
trigger1 = root,var(19)
trigger1 = animelem = 6
value = anim
elem = 5

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = !(root,stateno = 210)
trigger1 = (root,stateno = [200,220]) || (root,stateno = 410)
value = root,stateno + 5

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = (root,stateno = [1000,1100]) || (root,stateno = 2000||root,stateno = 2100||root,stateno = 2200) || (root,stateno = 3000)
value = root,stateno + 50

[State 0, explod]
type = explod
trigger1 = animtime = -1
trigger2 = root,stateno != 210
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
anim = 7201
id = 7201
pos = 15,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = animtime = -1
trigger2 = root,stateno != 210
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
anim = 8201
id = 8201
pos = 15,-40
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0
[State 0, snd]
type = playsnd
trigger1 = animtime = -1
trigger2 = root,stateno != 210
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
value = 12,1

[State 0, end]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno != 210 && root,stateno != 420 && root,stateno != 1200
value = 10000

;---------------------------------------------------------------------------
;立ちC
[Statedef 220]
type    = S
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 220
sprpriority = 1

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(3) >= 0
var(4)= 1
ignorehitpause = 1

[State 200, 物理的なキャラの幅]
type = Width
trigger1 = (AnimElemTime (2) >= 0) && (AnimElemTime (3) < 0)
value = 10,0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = time = 1
value = 220,0+(random%2)
channel = 0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 3,4
channel = 1

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 2,9
channel = 2

[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 226
id = 220
facing = 1
postype = p1
pos = ceil(helper(10000),pos x+(10*facing) - pos x)*facing,-65
sprpriority = 3
ownpal = 1
vel = .8,-.5
removeongethit = 1
scale = .5,.5
ignorehitpause = 0
[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 227
id = 226
facing = 1
postype = p1
pos = ceil(helper(10000),pos x+(10*facing) - pos x)*facing,-60
sprpriority = 3
ownpal = 1
vel = .8,-.5
removeongethit = 1
removetime = -1
scale = .5,.5
ignorehitpause = 0
[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 228
id = 226
facing = 1
postype = p1
pos = ceil(helper(10000),pos x+(10*facing) - pos x)*facing,-65
sprpriority = 2
ownpal = 1
vel = .8,-.5
removeongethit = 1
removetime = -1
scale = .5,.5
ignorehitpause = 0

[State 0, end]
type = removeexplod
trigger1 = time = 25
id = 226

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 3
trigger2 = AnimElem = 4
attr = S, NA
animtype  = Hard
damage    = ceil(26*fVar(10)),0
guardflag = MA
pausetime = 4,4
sparkno = s6000
guard.sparkno = s6040
sparkxy = -10,-72
hitsound   = s2,7
guardsound = s10,0
priority = 4, Hit
ground.type = High
ground.slidetime = 22
guard.slidetime = 20
ground.hittime  = 20
guard.hittime  = 16
ground.velocity = 0
air.velocity = -4, -3.8 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 20,0
givepower = 10,0
fall = 0
air.fall = ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
sprpriority = 1
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 5
attr = S, NA
animtype  = Hard
damage    = ceil(30*fVar(10)),0
guardflag = MA
pausetime = 11,11
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-82
hitsound   = s2,7
guardsound = s10,0
priority = 4, Hit
ground.type = High
ground.slidetime = 22
guard.slidetime = 20
ground.hittime  = 20
guard.hittime  = 16
ground.velocity = -4
air.velocity = -4, -3.8 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 40,0
givepower = 20,0
fall = 0
air.fall = ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
sprpriority = 1
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;立ちC(S)
[Statedef 225]
type    = S
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 225
sprpriority = 2

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 30,0

[State 0, anim]
type = changeanim
trigger1 = root,var(19)
trigger1 = animelem = 3
value = anim
elem = 2
[State 0, anim]
type = changeanim
trigger1 = root,var(19)
trigger1 = animelem = 4
value = anim
elem = 3
[State 0, anim]
type = changeanim
trigger1 = root,var(19)
trigger1 = animelem = 5
value = anim
elem = 4
[State 0, anim]
type = changeanim
trigger1 = root,var(19)
trigger1 = animelem = 6
value = anim
elem = 5
[State 0, anim]
type = changeanim
trigger1 = root,var(19)
trigger1 = animelem = 7
value = anim
elem = 6

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = !(root,stateno = 220)
trigger1 = (root,stateno = [200,220]) || (root,stateno = 410)
value = root,stateno + 5

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = (root,stateno = [1000,1100]) || (root,stateno = 2000||root,stateno = 2100||root,stateno = 2200) || (root,stateno = 3000)
value = root,stateno + 50

[State 0, explod]
type = explod
trigger1 = animtime = -1
trigger2 = root,stateno != 220
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
anim = 7201
id = 7201
pos = 30,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = animtime = -1
trigger2 = root,stateno != 220
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
anim = 8201
id = 8201
pos = 30,-60
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0
[State 0, snd]
type = playsnd
trigger1 = animtime = -1
trigger2 = root,stateno != 220
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
value = 12,1

[State 0, end]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno != 220 && root,stateno != 420 && root,stateno != 1200
value = 10000

;---------------------------------------------------------------------------
;DC
[Statedef 230]
type    = S
movetype= A
physics = N
poweradd= 0
ctrl = 0
anim = 230
sprpriority = 1

[State 0, end]
type = varadd
trigger1 = var(7)
trigger1 = time = 1
var(58) = -5

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 物理的なキャラの幅]
type = Width
trigger1 = (AnimElemTime (2) >= 0) && (AnimElemTime (3) < 0)
value = 10,0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = time = 1
value = 230,0
channel = 0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 3,4
channel = 1

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 2,9
channel = 2

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 1
value = 230, 5 + (var(7) > 0)

[State 100, 3]
type = velmul
trigger1 = time <= 18
x = .95

[State 0, explod]
type = explod
trigger1 = time = 0
anim = 306
id = 238
facing = 1
postype = p1
pos = -5, -50
sprpriority = 2
ownpal = 1
removeongethit = 1
bindtime = -1
removetime = 90
scale = .5,.5
ignorehitpause = 0

[State 903, 時間停止]
type = modifyexplod
trigger1 = 1
angle = 40 + floor(time * 0.25)
id = 238

[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 236
id = 220
facing = 1
postype = p1
pos = 0,0
sprpriority = 3
ownpal = 1
scale = .75,.75
ignorehitpause = 0
[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 227
id = 236
facing = 1
postype = p1
pos = 0,-40
sprpriority = 3
ownpal = 1
removeongethit = 1
removetime = -1
bindtime = -1
scale = .75,.75
ignorehitpause = 0
[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 228
id = 236
facing = 1
postype = p1
pos = 0,-40
sprpriority = 2
ownpal = 1
removeongethit = 1
removetime = -1
bindtime = -1
scale = .75,.75
ignorehitpause = 0


[State 0, explod]
type = explod
trigger1 = time = 150
anim = 306
id = 305
facing = 1
postype = p1
pos = -5, -60
sprpriority = 2
ownpal = 1
removeongethit = 1
bindtime = -1
removetime = 90
scale = .5,.5
ignorehitpause = 0

[State 0, end]
type = removeexplod
trigger1 = animelem = 9
id = 236

[State 903, 時間停止]
type = removeexplod
trigger1 = !animtime
id = 238

[State 200, ヒット定義]
type = HitDef
triggerall = !var(7)
trigger1 = AnimElem = 3
attr = S, NA
animtype  = up
damage    = ceil(62*fVar(10)), 0
guardflag = MA
pausetime = 16,16
sparkno = s6001
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = s2,1
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 20
ground.velocity = -3.5,-10.2 + fVar(20)
guard.velocity = -2
air.velocity = -3.5,-10.2 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 80,0
givepower = 40,0
fall = 1
air.fall = 1
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32
sprpriority = 1

[State 200, ヒットmax]
type = HitDef
triggerall = var(7)
trigger1 = AnimElem = 3
attr = S, NA
animtype  = up
damage    = ceil(80*fVar(10)), 0
guardflag = MA
pausetime = 16,16
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
guard.slidetime = 20
ground.velocity = -3.5,-12.5 + fVar(20)
guard.velocity = -2
air.velocity = -3.5,-12.5 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 80,0
givepower = 40,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
id = 1200
sprpriority = 2

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;屈A
[Statedef 400]
type    = C
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 400
sprpriority = 2

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(2) >= 0
var(4)= 1
ignorehitpause = 1

[State 200, 物理的なキャラの幅]
type = Width
trigger1 = (AnimElemTime (2) >= 0) && (AnimElemTime (4) < 0)
value = 10,0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = !time
value = 400,0
channel = 0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 3,0
channel = 1

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 2
attr = C, NA
animtype  = Light
damage    = ceil(24*fVar(10)),0
guardflag = L
pausetime = 11,11
sparkno = s6000
guard.sparkno = s6040
sparkxy = -10,-15
hitsound   = s5,0
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 12
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -4
air.velocity = -4, -3.8 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 40,0
givepower = 20,0
fall = 0
air.fall = ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;屈B
[Statedef 410]
type    = C
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 410
sprpriority = 2

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(3) >= 1
var(4)= 1
ignorehitpause = 1

[State 200, 物理的なキャラの幅]
type = Width
trigger1 = (AnimElemTime (3) >= 1) && (AnimElemTime (4) < 0)
value = 20,0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = !time
value = 410,0+(random%2)
channel = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 1
anim = 417
id = 415
facing = 1
postype = p1
pos = ceil(helper(10000),pos x+(10*facing) - pos x)*facing,0
sprpriority = 2
ownpal = 1
removeongethit = 1
;removetime = -1
scale = .5,.25
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 1
anim = 8101
id = 8100
facing = 1
postype = p1
pos = ceil(helper(10000),pos x+(5*facing) - pos x)*facing,0
sprpriority = -1
ownpal = 1
removeongethit = 1
;removetime = -1
scale = .25,.25
ignorehitpause = 0

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 4
attr = C, NA
animtype  = medium
damage    = ceil(20*fVar(10)),0
guardflag = L
pausetime = 4,4
sparkno = s6001
guard.sparkno = s6040
sparkxy = -10,-8
hitsound   = s2,7
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 16
guard.slidetime = 14
ground.hittime  = 14
ground.velocity = 0
air.velocity = -4, -3.8 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 20,0
givepower = 12,0
fall = 0
air.fall = ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32


[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 5
attr = C, NA
animtype  = medium
damage    = ceil(25*fVar(10)),0
guardflag = L
pausetime = 11,11
sparkno = s6001
guard.sparkno = s6040
sparkxy = -10,-8
hitsound   = s2,7
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 16
guard.slidetime = 14
ground.hittime  = 14
ground.velocity = -4
air.velocity = -4, -3.8 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 30,0
givepower = 15,0
fall = 0
air.fall = ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;2B(S)
[Statedef 415]
type    = S
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 415
sprpriority = 2

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 30,0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 8
value = 3,3

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 8
value = 2,7
channel = 1

[State 0, anim]
type = changeanim
trigger1 = root,var(19)
value = anim
elem = 8+(animelemtime(8)>=0)

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = !(root,stateno = 410)
trigger1 = (root,stateno = [200,220]) || (root,stateno = 410)
value = root,stateno + 5

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = (root,stateno = [1000,1100]) || (root,stateno = 2000||root,stateno = 2100||root,stateno = 2200) || (root,stateno = 3000)
value = root,stateno + 50

[State 0, explod]
type = explod
trigger1 = animtime = -1
trigger2 = root,stateno != 410
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
anim = 7201
id = 7201
pos = 0,-20
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = animtime = -1
trigger2 = root,stateno != 410
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
anim = 8201
id = 8201
pos = 0,0
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0
[State 0, snd]
type = playsnd
trigger1 = animtime = -1
trigger2 = root,stateno != 410
trigger2 = ((root,stateno != [1000,1999]) && root,movetype = H)
value = 12,1

[State 0, end]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno != 410 && root,stateno != 420 && root,stateno != 1200
value = 10000

;---------------------------------------------------------------------------
;屈C
[Statedef 420]
type    = C
movetype= A
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
anim = 420
sprpriority = 2

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(2) >= 0
var(4)= 1
ignorehitpause = 1

[State 200, 物理的なキャラの幅]
type = Width
trigger1 = (AnimElemTime (3) >= 0) && (AnimElemTime (6) < 0)
value = 10,0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = !time
value = 420,0+(random%2)
channel = 0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 3
value = 3,4
channel = 1

[State 0, explod]
type = explod
trigger1 = animelemtime(1) = 0
anim = 421
id = 421
facing = 1
postype = p1
pos = -5,0
sprpriority = 1
ownpal = 1
removeongethit = 1
bindtime = -1
scale = .5,.6
ignorehitpause = 0

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 2
attr = C, NA
animtype  = hard
damage    = ceil(80*fVar(10)),0
guardflag = L
pausetime = 11,11
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-10
hitsound   = s5,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 22
guard.slidetime = 20
ground.hittime  = 20
guard.hittime  = 16
ground.velocity = -3,-4 + fVar(20)
air.velocity = -3,-4 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 80,0
givepower = 40,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;ジャンプA
[Statedef 600]
type    = A
movetype= A
physics = A
poweradd= 0
ctrl = 0
anim = 600
sprpriority = 2

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(2) >= 0
var(4)= 1
ignorehitpause = 1

[State 600, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(1)= 0

[State 600, 変数]
type = VarSet
triggerall = movecontact || movereversed
trigger1 = AnimElemTime(2) >= 0
var(1)= 1
ignorehitpause = 1

[State 600, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 3,0
channel = 1

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = var(8) = 0
trigger1 = time = 1
value = 600,0+(random%2)
channel = 0

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 2
attr = A, NA
animtype  = light
damage    = ceil(25*fVar(10)),0
guardflag = HA
pausetime = IfElse(var(8) > 0, 30, 11), IfElse(var(8) > 0, 30, 11)
sparkno = -1
guard.sparkno = s6040
sparkxy = -36,-60
hitsound   = -1
guardsound = s10,0
priority = 4, Hit
ground.type = high
ground.slidetime = IfElse(var(8) > 0, 30, 14)
ground.hittime  = IfElse(var(8) > 0, 30, 14)
guard.hittime = 14
guard.ctrltime = 14
ground.velocity = -4
guard.velocity = IfElse(var(8) > 0, -11, -4)
air.velocity = -3.4, -4 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 40,0
givepower = 20,(var(8)>0)*300
fall = 0
air.fall = ifelse(p2Movetype=H || var(8) > 0,1,0)
fall.recover = 0
down.bounce = 0

[State 0, assault]
type = playsnd
trigger1 = MoveHit = 1
value = 5, IfElse(var(8) > 0, 12, 0)
ignorehitpause = 1
persistent = 0

[State 0, assault]
type = explod
trigger1 = MoveHit = 1
anim = IfElse(var(8) > 0, 6700, 6000)
pos = 36,-60
postype = p1
sprpriority = 3
ownpal = 1
scale = 1, 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
persistent = 0

[state 300001, helper]
type = helper
trigger1 = var(8) > 0
trigger1 = TeamMode != Simul
trigger1 = MoveContact = 1
helpertype = normal
name = "Zoom"
postype = p1
pos = 0,0
stateno = 705
id = 705
ignorehitpause = 1
persistent = 0

[State 600, 特殊]
type = StateTypeSet
trigger1 = AnimElemTime(3) >= 0
statetype = A
movetype= I

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 600, ステート変更]
type = null;CtrlSet
trigger1 = AnimElemTime(3) = 0
value = 1

;---------------------------------------------------------------------------
;ジャンプB
[Statedef 610]
type    = A
movetype= A
physics = N
poweradd= 0
ctrl = 0
anim = 610
sprpriority = 2

[State 100, 3]
type = veladd
trigger1 = 1
y = IfElse(var(8) > 0, 0.6, Const(movement.yaccel))

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(2) >= 0
var(4)= 1
ignorehitpause = 1

[State 600, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(1)= 0

[State 600, 変数]
type = VarSet
triggerall = movecontact || movereversed
trigger1 = AnimElemTime(2) >= 0
var(1)= 1
ignorehitpause = 1

[State 600, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2;3
value = 3,1
channel = 1

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = var(8) = 0
trigger1 = time = 1
value = 610,0+(random%2)
channel = 0

[State 200, ヒット定義]
type = HitDef
triggerall = !movecontact
trigger1 = AnimElem = 2
trigger2 = AnimElem = 3
attr = A, NA
animtype  = medium
damage    = ceil(40* (1+((var(8) > 0)*0.5)) *fVar(10)),0
guardflag = HA
pausetime = IfElse(var(8) > 0, 30, 11), IfElse(var(8) > 0, 30, 11)
sparkno = -1
guard.sparkno = s6040
sparkxy = -46,-70
hitsound   = -1
guardsound = s10,0
priority = 4, Hit
ground.type = high
ground.slidetime = IfElse(var(8) > 0, 30, 14)
ground.hittime  = IfElse(var(8) > 0, 30, 14)
guard.hittime = 14
guard.ctrltime = 14
ground.velocity = -4
guard.velocity = IfElse(var(8) > 0, -11, -4)
air.velocity = IfElse(var(8) > 0, -2, -3.4), IfElse(var(8) > 0, -8, -4 + fVar(20))
airguard.velocity = IfElse(var(8) > 0, -11, -3.4), -2
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 50,0
givepower = 25,(var(8)>0)*300
fall = 0
air.fall = ifelse(p2Movetype=H || var(8) > 0,1,0)
fall.recover = 0
down.bounce = 0

[State 0, assault]
type = playsnd
trigger1 = MoveHit = 1
value = 5, IfElse(var(8) > 0, 12, 1)
ignorehitpause = 1
persistent = 0

[State 0, assault]
type = explod
trigger1 = MoveHit = 1
anim = IfElse(var(8) > 0, 6700, 6001)
pos = 46,-70
postype = p1
sprpriority = 3
ownpal = 1
scale = 1, 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
persistent = 0

[state 300001, helper]
type = helper
trigger1 = var(8)
trigger1 = TeamMode != Simul
trigger1 = MoveContact = 1
helpertype = normal
name = "Zoom"
postype = p1
pos = 0,0
stateno = 705
id = 705
ignorehitpause = 1
persistent = 0

[State 600, 特殊]
type = StateTypeSet
trigger1 = AnimElemTime(4) >= 0
statetype = A
movetype= I

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 100, 3]
type = ChangeState
trigger1 = vel y > 0 && pos y >= 0
value = 52

;---------------------------------------------------------------------------
;ジャンプC
[Statedef 620]
type    = A
movetype= A
physics = N
poweradd= 0
ctrl = 0
anim = 620
sprpriority = 2

[State 100, 3]
type = veladd
trigger1 = 1
y = IfElse(var(8) > 0, 0.6, Const(movement.yaccel))

[State 200, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(4)= 0

[State 200, 変数]
type = VarSet
triggerall = movecontact
trigger1 = AnimElemTime(2) >= 0
var(4)= 1
ignorehitpause = 1

[State 600, 変数]
type = VarSet
trigger1 = AnimElemTime(1) = 0
var(1)= 0

[State 600, 変数]
type = VarSet
triggerall = movecontact || movereversed
trigger1 = AnimElemTime(2) >= 0
var(1)= 1
ignorehitpause = 1

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = var(8) = 0
trigger1 = time = 1
value = 620,0+(random%2)
channel = 0

[State 600, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 3,3
channel = 1

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 2
attr = A, NA
animtype  = hard
damage    = ceil(70* (1+((var(8) > 0)*0.5)) *fVar(10)),0
guardflag = HA
pausetime = IfElse(var(8) > 0, 30, 11), IfElse(var(8) > 0, 30, 11)
sparkno = -1
guard.sparkno = s6040
sparkxy = -56,-42
hitsound   = -1
guardsound = s10,0
priority = 4, Hit
ground.type = high
ground.slidetime = IfElse(var(8) > 0, 30, 14)
ground.hittime  = IfElse(var(8) > 0, 30, 14)
guard.hittime = 14
guard.ctrltime = 14
ground.velocity = -4
guard.velocity = IfElse(var(8) > 0, -11, -4)
air.velocity = IfElse(var(8) > 0, -2, -3.4), IfElse(var(8) > 0, -8, -4 + fVar(20))
airguard.velocity = IfElse(var(8) > 0, -11, -3.4), -2
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 80*!(var(6)),0
givepower = 40,(var(8)>0)*300
fall = 0
air.fall = ifelse(p2Movetype=H || var(8) > 0,1,0)
fall.recover = 0
down.bounce = 0
guard.kill = 0

[State 0, assault]
type = playsnd
trigger1 = MoveHit = 1
value = 5, IfElse(var(8) > 0, 12, 2)
ignorehitpause = 1
persistent = 0

[State 0, assault]
type = explod
trigger1 = MoveHit = 1
anim = IfElse(var(8) > 0, 6700, 6002)
pos = 56,-42
postype = p1
sprpriority = 3
ownpal = 1
scale = 1, 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
persistent = 0

[state 300001, helper]
type = helper
trigger1 = var(8)
trigger1 = TeamMode != Simul
trigger1 = MoveContact = 1
helpertype = normal
name = "Zoom"
postype = p1
pos = 0,0
stateno = 705
id = 705
ignorehitpause = 1
persistent = 0

[State 600, 特殊]
type = StateTypeSet
trigger1 = AnimElemTime(4) >= 0
statetype = A
movetype= I

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 100, 3]
type = ChangeState
trigger1 = vel y > 0 && pos y >= 0
value = 52

;---------------------------------------------------------------------------
;assault
[Statedef 700]
type    = S
physics = N
ctrl = 0
anim = 700
sprpriority = 0
velset = 0,0
powerAdd = 50

[State 100, 1]
type = varset
trigger1 = !time
var(8) = 1

[State 40, HitBy]
type = HitBy
trigger1 = Time < 8
value = SCA, NA,SA,HA,NP,SP,HP

[State 0, explod]
type = explod
trigger1 = Time = 3
anim = 111
facing = -1
postype = p1
pos = 0,-80
sprpriority = 0
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1;.5,.5
angle = -45
persistent = 0

[State 0, explod]
type = explod
trigger1 = Time = 8
anim = 6070
postype = p1
pos = 0,0
sprpriority = 2
ownpal = 1
Scale = 0.5,0.5

[State 0, snd]
type = playsnd
trigger1 = Time = 1
value = 700, random%2
channel = 0

[State 100, 1]
type = playsnd
trigger1 = Time = 8
value = 3,8

[State 100, 1]
type = VelSet
trigger1 = Time = 8
x = IfElse(P2Dist x / 32 <= 0.5, 0.5, IfElse(P2Dist x / 32 > Const(velocity.jump.fwd.x)*2, Const(velocity.jump.fwd.x)*2, P2Dist x / 32))
y = -7.8

[State 100, 3]
type = veladd
trigger1 = Time >= 8
y = IfElse(Time >= 18, 0.6, 0.5)

[State 100, 3]
type = velmul
trigger1 = Time = 18
x = .8

[State 0, state]
type = statetypeset
trigger1 = Time = 8
statetype = A
ignorehitpause = 1

[State -3, ExShadow]
type = afterimage
trigger1 = time = 1
time = 40
timegap = 3
framegap = 1
length = 8
palbright = 32,32,32
palcontrast = 128,128,128
paladd = 256, 32, 32
trans = add
ignorehitpause = 1

[State 100, 3]
type = ChangeState
trigger1 = vel y > 0 && pos y >= 0
value = 52

;-----------------------------------------------------------------------------
[Statedef 705]
type = A
velset = 0, 0
anim = 9999
sprpriority = 5

[State 3000, ZOOM]
type = zoom
trigger1 = time<=4
scale = 1 + (0.0625*time)
pos = root, pos x+5*(root,facing), root, pos y
ignorehitpause = 1

[State 3000, ZOOM]
type = zoom
trigger1 = time>4
trigger1 = time<=30-4
scale = 1.25
pos = root, pos x+5*(root,facing), root, pos y
ignorehitpause = 1

[State 3000, ZOOM]
type = zoom
trigger1 = time>30-4
trigger1 = time<=30
scale = 1.25 - (0.0625*(time-(30-4)))
pos = root, pos x+5*(root,facing), root, pos y+((time-(30-4))*5)
ignorehitpause = 1

[State 8500, End]
type = DestroySelf
trigger1 = Time >= 30

;===========================================================================
;アドバンシングガード
[Statedef 710]
type = U
movetype = H
physics = N
ctrl = 0
velset = 0,0
poweradd = -500

;bg
[State 0, snd]
type = bgpalfx
trigger1 = !time
add = 128-time*32,128-time*32,128-time*32
time = 4
ignorehitpause = 1

[State 0, vel]
type = velset
trigger1 = 1
x = 0

[State 0, explod]
type = explod
trigger1 = !time
anim = 710
id = 710
pos = 20,-60
postype = p1
scale =1,1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
pausemovetime = 99999
supermovetime = 99999

[State 0, snd]
type = playsnd
trigger1 = !time
value = 710,random%2
channel = 10

[State 0, snd]
type = playsnd
trigger1 = !time
value = 715,0

[State 0, vel]
type = pause
trigger1 = !time
time = 15

[state 0, helper]
type = helper
trigger1 = !time
helpertype = normal
name = "AVG"
stateno = 715
id = 715
pos = -10,0
postype = p1
keyctrl = 0
pausemovetime = 999999
supermovetime = 999999
size.ground.back = 20
size.ground.front = 20
size.height = 240

[State 0, anim]
type = changeanim
trigger1 = !var(59)
trigger1 = time >= 0 && command != "holddown"
value = 150

[State 0, anim]
type = changeanim
trigger1 = !var(59)
trigger1 = time >= 0 && command = "holddown"
value = 151


[State 0, state]
type = statetypeset
trigger1 = !var(59)
trigger1 = command != "holddown"
statetype = S
physics = S

[State 0, state]
type = statetypeset
trigger1 = !var(59)
trigger1 = command = "holddown"
statetype = C
physics = C

[State 0, nhb]
type = nothitby
trigger1 = time <= 1
value = SCA
time = 1

[State 0, end]
type = changestate
trigger1 = time = 1
value = 151+(command = "holddown")*2

;---------------------------------------------------------------------------
;アドバンシングガード2
[Statedef 711]
type = U
movetype = I
physics = N

[State 0, vel]
type = velset
trigger1 = 1
x = 0

[State 0, anim]
type = changeanim
trigger1 = time >= 0 && command != "holddown"
value = 150

[State 0, anim]
type = changeanim
trigger1 = time >= 0 && command = "holddown"
value = 151

[State 0, state]
type = statetypeset
trigger1 = command != "holddown"
statetype = S
physics = S

[State 0, state]
type = statetypeset
trigger1 = command = "holddown"
statetype = C
physics = C

[State 0, end]
type = changestate
trigger1 = numhelper(715)
trigger1 = command = "holdback"
value = 151+(command = "holddown")*2

[State 0, end]
type = changestate
trigger1 = !numhelper(715)
value = 130+(command = "holddown")
ctrl = 1

;---------------------------------------------------------------------------
;アドバンシングガード(ヘルパー)
[Statedef 715]
type = S
movetype = I
physics = N
anim = 715
velset = 0,0

[State 0, push]
type = playerpush
trigger1 = 1
value = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, vel]
type = velset
trigger1 = time = 15
x = 20

[State 0, end]
type = DestroySelf
trigger1 = root,stateno != [700,799]
trigger1 = root,stateno != [120,159]
trigger2 = root,stateno = 150 || root,stateno = 152

;---------------------------------------------------------------------------
;ガーキャン
[Statedef 720]
type    = S
movetype= A
physics = N
poweradd= -1000
ctrl = 0
velset = 0,0
anim = 720
sprpriority = 2

[State 0, pal]
type = palfx
trigger1 = !time
sinadd = 128,128,128,2
time = 4
ignorehitpause = 1

[state 0, helper]
type = helper
trigger1 = !time
name = "gc"
stateno = 725
id = 725
postype = p1
pos = 0,0
ownpal = 1
size.xscale = 1
size.yscale = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = !time
value = 720, random%2
channel = 10

[State 0, snd]
type = playsnd
trigger1 = !time
value = 715,0

[State 0, super]
type = pause
trigger1 = time = 0
time = 30
movetime = 30

[State 200, 音を鳴らす]
type = nothitby
trigger1 = time <= 35
value = SCA

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 2
value = 3,2
channel = 1

[State 0, explod]
type = explod
trigger1 = !time
anim = 721
id = 721
postype = p1
pos = 0, 0
bindtime = -1
scale = const(size.xscale), const(size.yscale)
sprpriority = 2
ownpal = 1
ignorehitpause = 0
removeongethit = 1
pausemovetime = 999999
supermovetime = 999999

[State 200, ヒット定義]
type = HitDef
trigger1 = AnimElem = 2
attr = S, NA
animtype  = Midium
damage    = ceil(57*fVar(10)),0
guardflag = MA
pausetime = 16,16
sparkno = s6001
guard.sparkno = s6040
sparkxy = -10,-65
hitsound   = s5,2
guardsound = s10,0
priority = 7, Hit
ground.type = High
ground.slidetime = 12
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -7,-3 + fVar(20)
air.velocity = -7,-3 + fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 1
fall.recovertime = 18
down.bounce = 0
kill = 0

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;==============================================================================
;ガードキャンセルエフェクト
[Statedef 725]
ctrl = 0
anim = 20000

[State 0, bgpal]
type = bgpalfx
trigger1 = time < 13
time = 1
mul = 32+ceil(18.6*time),32+ceil(18.6*time),96+ceil(13.2*time)
color = 128+ceil(12.8*time)

[State 0, explod]
type = explod
trigger1 = !time
anim = 725
id = 725
postype = p1
pos = 21, -55
scale = .5, .5
sprpriority = 3
ownpal = 1
pausemovetime = -1
supermovetime = -1

[State 0, end]
type = DestroySelf
trigger1 = time = 30

;===========================================================================
; 投げ技
;===========================================================================
;カンフースルー：掴み
[Statedef 800]
type    = S
movetype= A
physics = N
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2

[State 800, 方向判定]
type = Varset
trigger1 = Time = 0
trigger1 = command != "holdback"
var(3) = 1

[State 800, 方向判定]
type = Varset
trigger1 = Time = 0
trigger1 = command != "holdfwd"
trigger1 = command = "holdback"
var(3) = -1

[State 800, 攻撃認識距離]
type = AttackDist
trigger1 = 1
value = 0

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = !time
value = 800,0+(random%2)
channel = 0

[State 800, ヒット定義（投げ用）]
type = HitDef
trigger1 = Animelem = 2
trigger1 = P2Movetype != H
trigger1 = P2StateNo != [150,155]
attr = S, NT
hitflag = M-
priority = 1, Miss
sparkno = -1
p1facing = ifelse((var(3)=-1),-1,1)
p2facing = 1
p1stateno = 810
p2stateno = 820
guard.dist = 0
numhits = 0
fall = 1

[State 800, ステート変更]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;成功（投げる）
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 40
sprpriority = 1

[State 810, 音を鳴らす];放り投げ用
type = PlaySnd
trigger1 = !time
value = 1,0

[State 810, 音を鳴らす];掴み用
type = PlaySnd
trigger1 = time = 5
value = 810,0+(random%2)
channel = 0

[State 810, 音を鳴らす];掴み用
type = PlaySnd
trigger1 = time = 25
value = 2,5
channel = 3

[State 810, 音を鳴らす];掴み用
type = PlaySnd
trigger1 = time = 35
value = 850,0

[State 810, 音を鳴らす];掴み用
type = PlaySnd
trigger1 = time = 65
value = 12,0
[State 810, 音を鳴らす];掴み用
type = PlaySnd
trigger1 = time = 70
value = 2,12

[State 0, explod]
type = explod
trigger1 = time = 35
anim = 227
id = 800
facing = 1
postype = p2
pos = 0,-40
sprpriority = 2
ownpal = 1
vel = 0,0
removeongethit = 1
removetime = -1
scale = 1,1
ignorehitpause = 0
[State 0, explod]
type = explod
trigger1 = time = 35
anim = 228
id = 800
facing = 1
postype = p2
pos = 0,-40
sprpriority = 2
ownpal = 1
vel = 0,0
removeongethit = 1
removetime = -1
scale = 1,1
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = time = 65
anim = 812
id = 812
facing = 1
postype = p1
pos = 70,-85
sprpriority = 1
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1.5,1.5

[State 810, 音を鳴らす];掴み用
type = stopsnd
trigger1 = time = 65
channel = 3

[State 0, explod]
type = explod
trigger1 = time = 70
anim = 6002
id = 6002
facing = 1
postype = p2
pos = 0,-45
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1
[State 0, explod]
type = explod
trigger1 = time = 70
anim = 6030
id = 6002
facing = 1
postype = p2
pos = 0,-45
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1
[State 0, explod]
type = explod
trigger1 = time = 70
anim = 6050
id = 6050
facing = 1
postype = p1
pos = 70,-85
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1

[State 810, 掴んだ相手の位置１]
type = removeexplod
trigger1 = time = 65
id = 800

[State 810, 掴んだ相手の位置１]
type = TargetBind
trigger1 = time < 11
pos = 60, 0

[State 810, 掴んだ相手の位置１]
type = TargetBind
trigger1 = time = [11,16]
pos = 50, 0

[State 810, 掴んだ相手の位置１]
type = TargetBind
trigger1 = time = [35,70]
pos = 53, -55

[State 810, 掴んだ相手のステート変更]
type = TargetState
trigger1 = time = 17
value = 821

[State 810, 物理的なキャラの幅]
type = Width
trigger1 = 1
edge = 70,0 ;画面端を押す幅を変える（オレンジの線）

[State 810, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = (time = [35,65])
value = -2
kill = 0

[State 810, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = time = 70
value = IfElse(var(7), -85, -55)
kill = 1

[State 810, 掴んだ相手のステート変更]
type = TargetState
trigger1 = time = 70
value = 822

[State 800, 方向判定]
type = Varset
trigger1 = Time = 70
var(14) = 1

[State 810, ステート変更]
type = ChangeState
trigger1 = time >= 120
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;投げ(スタンド)
[Statedef 860]
type = U
movetype = I
physics = N
ctrl = 0
anim = 850
velset = 0,0
sprpriority = 1

[State 0, btr]
type = nothitby
trigger1 = 1
value = SCA

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 30,0

[State 810, ステート変更]
type = changeanim
trigger1 = root,time = 80
value = 851

[State 0, end]
type = changestate
trigger1 = root,stateno != 810
value = 10000

;---------------------------------------------------------------------------
;相手側１
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[State 820, 相手のアニメ変更]
type = ChangeAnim2
trigger1 = Time = 0
value = 820

[State 820, 相手ステートに戻す]
type = SelfState
trigger1 = time = 60
value = 5050

;---------------------------------------------------------------------------
;相手1
[Statedef 821]
type = A
movetype = H
physics = N
velset = 0,0

[State 2500, ScreenBound]
type = velset
trigger1 = !time
x = -.1
y = -7.5

[State 2500, ScreenBound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 30,10

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = !time
trigger1 = SelfAnimExist(5051)
value = 5051

[State 2601, ChangeAnim] ;Change anim when done with transition
type = ChangeAnim
trigger1 = !time
trigger1 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5050
persistent = 0

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = !time
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = time = [18,47]
value = 5001+(random%2)*10

[State 0, pos]
type = posadd
trigger1 = time = [18,47]
x = 1*ifelse(time%2=0,-1,1)

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = time = 48
value = 5050

[State 2601, Pal]
type = PalFX
trigger1 = time = 18
time = 80
color= 32
sinadd = 10,30,60,8
mul = 128,256,512
time = 32

[State 2601, Vel]
type = VelAdd
trigger1 = 1
y = .4

[State 2601, Vel]
type = nothitby
trigger1 = 1
value = SCA

[State 2601, Vel]
type = playerpush
trigger1 = 1
value = 0

[State 2601, SelfState]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;---------------------------------------------------------------------------
;相手2
[Statedef 822]
type    = U
movetype = H
physics = N
ctrl = 0
velset = 0,0
sprpriority = 0

[State 7000, VarSet]
type = null;nothitby
trigger1 = 1
value = SCA

[State 7000, VarSet]
type = playerpush
trigger1 = 1
value = 0

[State 0, pos]
type = posadd
trigger1 = time <= 13
x = 1*ifelse(time%2=0,-1,1)

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = time <= 13
value = anim
elem = animelemno(0)

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = time = 13
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
triggerall = time >= 16
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 7000, VarSet]
type = velset
trigger1 = time = 3
x = -5
y = -5

[State 7000, VarSet]
type = veladd
trigger1 = time >= 3
y = .45

[State 821, ステート変更]
type = null;ChangeState
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive      ;生きている時
triggerall = CanRecover ;空中受け身が可能な時
trigger1 = Command = "recovery"
value = 5200

[State 821, 相手ステートに戻す]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;===========================================================================
;相手
[Statedef 5950]
type    = A
movetype= H
physics = N
poweradd= 0
velset = 0,0
ctrl = 0
sprpriority = 1

[State 0, pos]
type = posadd
trigger1 = time < 60
x = 1*ifelse(time%2=0,-1,1)

[State 200, ステート変更]
type = Changeanim
trigger1 = time < 60
value = 5011

[State 200, ステート変更]
type = Changeanim
trigger1 = time = 60
trigger1 = SelfAnimExist(5950)
value = 5950

[State 200, ステート変更]
type = Changeanim2
trigger1 = time = 60
trigger1 = !SelfAnimExist(5950)
value = 950

[State 200, ステート変更]
type = selfstate
trigger1 = anim = 5950
trigger1 = animtime = 65 || !animtime
trigger2 = anim = 950
trigger2 = !animtime
value = 5120

;===========================================================================
; 必殺技
;===========================================================================
;ジェットエンジンのようなパワー
[Statedef 1000]
type    = S
movetype= A
physics = N
poweradd= 50
velset = 0,0
anim = 1000
ctrl = 0
sprpriority = 1

[State 0, end]
type = varadd
trigger1 = var(7)
trigger1 = time = 1
var(58) = -5

[State 1000, end]
type = ChangeState
trigger1 = time > 0
trigger1 = helper(10000),stateno = 10000
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ジェットエンジンのようなパワー(Stand)
[Statedef 1050]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2

;template---
[State 0, hitvel]
type = stopsnd
trigger1 = time = 0
channel = 7

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = (PrevStateNo = 10000)
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 1000)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 0, var]
type = varset
trigger1 = !time
var(4) = 0

[State 0, anim]
type = changeanim
trigger1 = !time
value = 1050

[State 0, btr]
type = bindtoroot
trigger1 = prevstateno = 10000
trigger1 = time <= 1
pos = 10,0

[State 0, snd]
type = playsnd
trigger1 = anim = 1050
trigger1 = animelemtime(2) = 0
value = 3,8
persistent = 0

[State 0, explod]
type = explod
trigger1 = anim = 1051
trigger1 = animelemtime(2) = 0
anim = 111
facing = -1
postype = p1
pos = 0,-50
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = .5,.5
persistent = 0

[State 0, hitvel]
type = velset
trigger1 = anim = 1050
trigger1 = animelemtime(1) = 0
x = 3

[State 0, snd]
type = playsnd
trigger1 = anim = 1050
trigger1 = animelemtime(2) = 0
value = 1000,1
channel = 0

[State 0, hitvel]
type = velset
trigger1 = anim = 1050
trigger1 = animelemtime(2) = 0
x = 2
y = -4

[State 0, explod]
type = explod
trigger1 = anim = 1050
trigger1 = animelemtime(2) >= 0
trigger1 = !numexplod(1055)
anim = 1055
id = 1055
facing = 1
postype = p1
pos = 0,0
sprpriority = 3
ownpal = 1
bindtime = -1
removeongethit = 1
scale = .45,.6

[State 0, explod]
type = explod
trigger1 = anim = 1050
trigger1 = animelemtime(2) >= 0
anim = 1055
id = 1056
facing = 1
postype = p1
pos = 0+(random%20),-20+(random%40)
sprpriority = 3
ownpal = 1
bindtime = -1
removeongethit = 1
scale = .45,.6

[State 0, hitvel]
type = velmul
trigger1 = anim = 1050
trigger1 = animelemtime(2) >= 0
x = .95
y = .8

[State 0, var]
type = varset
trigger1 = !time
var(20) = 0
[State 0, var]
type = varadd
trigger1 = anim = 1050
trigger1 = animelemtime(2) >= 0
var(20) = 1

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 200, ヒット定義]
type = HitDef
triggerall = !root,var(7)
trigger1 = anim = 1050
trigger1 = AnimElemtime(3) = 0
attr = S, SA
animtype  = light
damage    = ceil(10*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(10*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,3
sparkno = s6000
guard.sparkno = s6040
sparkxy = -10-(random%20),-50-(random%20)
hitsound   = s5,0
guardsound = s10,0
priority = 4, Hit
ground.type = High
ground.slidetime = 15+(var(20)>=55)*10
ground.hittime  = 15+(var(20)>=55)*10
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -1;ifelse(var(20)<55,-1,-8)
guard.velocity = -1
air.velocity = -4, -3.8;; + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 1,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32

[State 200, ヒット定義]
type = HitDef
triggerall = root,var(7)
trigger1 = anim = 1050
trigger1 = AnimElemtime(3) = 0
attr = S, SA
animtype  = light
damage    = ceil(10*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(1*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,3
sparkno = s6000
guard.sparkno = s6040
sparkxy = -10-(random%20),-50-(random%20)
hitsound   = s2,7
guardsound = s10,0
priority = 4, Hit
ground.type = High
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -1;ifelse(var(20)<55,-1,-8)
guard.velocity = -1
air.velocity = -4, -3.8;; + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 1,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32

[State 0, var]
type = varset
trigger1 = movecontact = 1
var(4) = 1

[State 0, end]
type = varset
trigger1 = movecontact = 1
var(49) = 1
ignorehitpause = 1

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1

[State 0, end]
type = poweradd
trigger1 = var(49)
value = 2
ignorehitpause = 1
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
ignorehitpause = 1

[State 0, hitvel]
type = changestate
trigger1 = anim = 1050
trigger1 = var(20) >= 60
value = 1051

;---------------------------------------------------------------------------
;ジェットエンジンのようなパワー2(Stand)
[Statedef 1051]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2

;template---
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 1000)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 0, var]
type = varset
trigger1 = time = 0
var(4) = 0

[State 0, snd]
type = playsnd
trigger1 = !time
value = 1001,0+(random%2)
channel = 0

[State 0, hitvel]
type = changeanim
trigger1 = !time
value = 1053

[State 0, hitvel]
type = velset
trigger1 = !time
x = -8
[State 0, hitvel]
type = veladd
trigger1 = animelemtime(2) < 6
x = 1.4
[State 0, hitvel]
type = velset
trigger1 = animelemtime(2) = 6
x = 0


[State 0, hitvel]
type = changeanim
trigger1 = anim = 1053
trigger1 = movecontact = 1 || movereversed = 1
value = 1053
elem = 3

[State 0, hitvel]
type = velmul
triggerall = anim = 1053
trigger1 = animelemtime(3) >= 0
x = .5

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 100,00]
type = Afterimage
trigger1 = !time
trans = add
TimeGap = 1
FrameGap = 3
time = 20
palcolor = 0
PalBright = 20,20,80
PalContrast = 80,80,255
length = 10
palinvertall = 1
ignorehitpause=1

[State 200, ヒット定義]
type = HitDef
triggerall = !root,var(7)
trigger1 = anim = 1053
trigger1 = AnimElem = 2
attr = S, SA
animtype  = diagup
damage    = ceil(50*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(50*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 16,16
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -6,-3.5;; + root,fVar(20)
guard.velocity = -2
air.velocity = -6,-3.5;; + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 25,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32
sprpriority = 2

[State 200, ヒット定義]
type = HitDef
triggerall = root,var(7)
trigger1 = anim = 1053
trigger1 = AnimElem = 2
attr = S, SA
animtype  = diagup
damage = ceil(100*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(100*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 21,21
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -6,-3.5;; + root,fVar(20)
guard.velocity = -2
air.velocity = -6,-3.5;; + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 25,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
sprpriority = 2

[State 0, var]
type = parentvaradd
trigger1 = movecontact = 1
var(46) = 1

;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[State 0, end]
type = varset
trigger1 = movehit = 1
var(49) = 1
ignorehitpause = 1
persistent = 0

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1

[State 0, end]
type = poweradd
trigger1 = var(49)
value = 50
ignorehitpause = 1
persitent = 0
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
ignorehitpause = 1

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 7201
id = 7201
pos = 0,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 8201
id = 8201
pos = 0,-50
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !animtime
value = 12,1

[State 0, hitvel]
type = changestate
trigger1 = !animtime
value = 10000

;---------------------------------------------------------------------------
;ここねらってよ！ここ
[Statedef 1100]
type    = S
movetype= A
physics = N
poweradd= 0
velset = 0,0
anim = 1100
ctrl = 0
sprpriority = 1

[State 1000, ステート変更]
type = attackdist
trigger1 = 1
value = 0

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 1100,0
channel = 0

[State 1001]
type = reversaldef
trigger1 = animElemtime(2) >= 0
trigger1 = animElemtime(14) < 0
reversal.attr = SCA,NA,SA
pausetime = 0,40
p1stateno = 1101
sparkno = s7200
sparkxy = 25,-10
hitsound = s7,0

[State 1000, end]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ここねらってよ！ここ(suc)
[Statedef 1101]
type    = S
movetype= A
physics = N
poweradd= 0
velset = 0,0
anim = 1000
ctrl = 0
sprpriority = 1

[State 0, snd]
type = playsnd
trigger1 = !time
value = 1101,0+(random%2)
channel = 0

[State 1000, ステート変更]
type = ChangeState
trigger1 = time > 68
value = 0
ctrl = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = helper(10000),stateno = 10000
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ここねらってよ！ここ(Stand)
[Statedef 1150]
type = U
movetype = I
physics = N
ctrl = 0
sprpriority = 2

;template---
[State 0, hitvel]
type = stopsnd
trigger1 = time = 0
channel = 7

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 1100)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 0, anim]
type = changeanim
trigger1 = !time
value = 1150

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 30,0

[State 0, end]
type = varset
trigger1 = movehit = 1
var(49) = 1
ignorehitpause = 1

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1

[State 0, end]
type = poweradd
trigger1 = var(49)
value = 2
ignorehitpause = 1
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
ignorehitpause = 1

[State 0, explod]
type = explod
trigger1 = time = 68
anim = 7201
id = 7201
pos = 0,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 68
anim = 8201
id = 8201
pos = 0,-50
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = time = 68
value = 12,1

[State 0, hitvel]
type = changestate
trigger1 = root,stateno = 1101
value = 1151

[State 0, hitvel]
type = changestate
trigger1 = time = 68
value = 10000

;---------------------------------------------------------------------------
;ここねらってよ！ここ2(Stand)
[Statedef 1151]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2
anim = 1151

;template---
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 1100)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 0, end]
type = playsnd
trigger1 = !time
value = 2,6
channel = 1

[State 0, explod]
type = explod
trigger1 = !time
anim = 227
id = 226
facing = 1
postype = p1
pos = 0,-60
sprpriority = 3
ownpal = 1
vel = 0,0
removeongethit = 1
bindtime = -1
removetime = 70
scale = .5,.5
ignorehitpause = 0
[State 0, explod]
type = explod
trigger1 = !time
anim = 228
id = 226
facing = 1
postype = p1
pos = 0,-65
sprpriority = 2
ownpal = 1
vel = .8,-.5
removeongethit = 1
bindtime = -1
removetime = 70
scale = .5,.5
ignorehitpause = 0

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, hitvel]
type = velmul
trigger1 = 1
x = .5
y = .8

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 0, explod]
type = explod
trigger1 = time = 34
anim = 6030
id = 6002
facing = 1
postype = p2
pos = 0,-45
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = time = 34
anim = 6050
id = 6050
facing = 1
postype = p2
pos = 0,-45
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1
ignorehitpause = 1

[State 200, ヒット定義]
type = HitDef
triggerall = !root,var(7)
trigger1 = animelem = 2
attr = S, SA
animtype  = diagup
damage    = ceil(75*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(75*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 16,16
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -7,-4.5
guard.velocity = -2
air.velocity = -7,-4.5
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 40,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32

[State 200, ヒット定義]
type = HitDef
triggerall = root,var(7)
trigger1 = animelem = 2
attr = S, SA
animtype  = diagup
damage    = ceil(75*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(75*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 16,16
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -7,-4.5
guard.velocity = -2
air.velocity = -7,-4.5
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 40,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
sprpriority = 2
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32

[state 4100, 1]
type = envcolor
trigger1 = movehit = 1
value = 255,255,255
time = 2
ignorehitpause = 1
persistent = 0

;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[State 0, end]
type = varset
trigger1 = movehit = 1
var(49) = 1
ignorehitpause = 1
persistent = 0

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1

[State 0, end]
type = poweradd
trigger1 = var(49)
value = 80
ignorehitpause = 1
persitent = 0
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
ignorehitpause = 1

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 7201
id = 7201
pos = 0,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 8201
id = 8201
pos = 0,-50
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !animtime
value = 12,1

[State 0, hitvel]
type = changestate
trigger1 = !animtime
value = 10000

[State 0, hitvel]
type = changestate
trigger1 = root,stateno != 1101
value = 10000

;---------------------------------------------------------------------------
;スピットファイヤー
[Statedef 1200]
type    = S
movetype= A
physics = N
poweradd= 50
velset = 0,0
anim = 1200
ctrl = 0
sprpriority = 1

[State 0, end]
type = varadd
trigger1 = var(7)
trigger1 = time = 1
var(58) = -5

[State 0, snd]
type = varset
trigger1 = !time
var(20) = 0

[State 0, snd]
type = varset
Trigger1 = !var(59)
trigger1 = !time
var(2) = ifelse(command="41236z",2,ifelse(command="41236y",1,0))

[State 0, snd]
type = varset
triggerall = var(59)
triggerall = !time
trigger1 = p2bodydist x = [100,129]
var(2) = 1

[State 0, snd]
type = varset
triggerall = var(59)
triggerall = !time
trigger1 = var(37) = 2
trigger1 = var(36) = 0
trigger2 = p2bodydist x > 130
var(2) = 2

[State 0, snd]
type = playsnd
trigger1 = !time
value = 1200,0
channel = 0

[State 3000]
type = Helper
trigger1 = !time
helpertype = normal
name = "heri"
stateno = 1210
id = 1200
pos = 0,-100
postype = p1
ownpal = 1
facing = 1
size.xscale = .5
size.yscale = .5

[State 1000, ステート変更]
type = Changeanim
triggerall = time > 26
triggerall = anim != 1201
trigger1 = var(20)
trigger2 = time > 60
value = 1201

[State 1000, ステート変更]
type = ChangeState
trigger1 = anim = 1201 && !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;スピットファイヤー(stand)
[Statedef 1250]
type    = S
movetype= I
physics = N
poweradd= 0
velset = 0,0
anim = 9999
ctrl = 0
sprpriority = 1

[State 0, hitvel]
type = stopsnd
trigger1 = time = 0
channel = 7

[State 1000, ステート変更]
type = ChangeState
trigger1 = root,stateno != 1200
trigger2 = time > 90
value = 10000

;---------------------------------------------------------------------------
;スピットファイヤー(ヘリ)
[Statedef 1210]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2
anim = 1210

[State 100,00]
type = Afterimage
trigger1 = !time
trans = add
TimeGap = 2
FrameGap = 2
time = 60
palcolor = 0
PalBright = 20,20,80
PalContrast = 80,80,255
length = 10
palinvertall = 1
ignorehitpause=1

[State 0, explod]
type = explod
triggerall = anim = 1210
trigger1 = animelemtime(2) = 0
anim = 7200
id = 7200
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
triggerall = anim = 1210
trigger1 = animelemtime(2) = 0
anim = 8201
id = 8201
pos = 0,15
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = !time
value = 1200,1
channel = 7

[State 0, anim]
type = angleset
trigger1 = !time
value = -40

[State 0, anim]
type = angledraw
trigger1 = 1

[State 0, anim]
type = angleadd
triggerall = !((movecontact = [1, 11]) || (movereversed = [1, 11]))
triggerall = anim = 1210
trigger1 = animelemtime(2) >= 0
value = 2+(vel y < -6)

[State 0, anim]
type = palfx
trigger1 = root,var(7)
trigger1 = !time
color = 128
mul = 206,206,180
sinadd = 128,96,32,8
time = 60

[State 0, btr]
type = bindtoroot
triggerall = anim = 1210
trigger1 = animelemtime(2) < 0
pos = -10,-120

[State 0, hitvel]
type = velset
triggerall = anim = 1210
trigger1 = animelemtime(2) = 0
x = 4+(root,var(2)*1.5)
y = 5

[State 0, hitvel]
type = null;velmul
triggerall = anim = 1210
trigger1 = animelemtime(2) >= 0
x = .98

[State 0, hitvel]
type = veladd
triggerall = anim = 1210
trigger1 = animelemtime(2) >= 0
y = -.3

[State 0, explod]
type = null;explod
triggerall = anim = 1210
trigger1 = anim = 1052
anim = 1055
id = 1056
facing = 1
postype = p1
pos = 0+(random%20),-20+(random%40)
sprpriority = 3
ownpal = 1
bindtime = -1
removeongethit = 1
scale = .45,.6

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 200, ヒット定義]
type = HitDef
triggerall = !root,var(7)
triggerall = anim = 1210
trigger1 = animelemtime(2) >= 0
trigger1 = !movecontact && !movereversed
attr = S, SP
animtype  = light
damage    = ceil(80*root,fVar(10)),ceil(80*.20*root,fVar(10))
guardflag = MA
pausetime = 0,11
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,0
hitsound   = s5,5
guardsound = s10,0
priority = 4, Hit
ground.type = High
ground.slidetime = 12
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -5
guard.velocity = -3.5
air.velocity = -4, -3.8 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 1,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0

[State 200, ヒット定義]
type = HitDef
triggerall = root,var(7)
triggerall = anim = 1210
trigger1 = animelemtime(2) >= 0
trigger1 = !movecontact && !movereversed
attr = S, SA
animtype  = light
damage    = ceil(80*root,fVar(10)),ceil(80*.20*root,fVar(10))
guardflag = MA
pausetime = 0,11
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,0
hitsound   = s5,5
guardsound = s10,0
priority = 4, Hit
ground.type = High
ground.slidetime = 12
guard.slidetime = 10
ground.hittime  = 10
ground.velocity = -5
guard.velocity = -1
air.velocity = -4, -3.8 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 1,0
fall = 0+(root,var(21))
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
id = 1200

[State 0, end]
type = playsnd
trigger1 = numtarget(1200)
trigger1 = target(1200),alive
trigger1 = target(1200),statetype != A
trigger1 = movehit = 1
value = 2,12
ignorehitpause = 1
persistent = 0

[State 0, pos]
type = targetstate
triggerall = !root,var(21)
trigger1 = numtarget(1200)
trigger1 = target(1200),alive
trigger1 = target(1200),statetype != A
trigger1 = movehit = 1
value = 1260
id = 1200

[State 0, pos]
type = parentvarset
trigger1 = numtarget(1200)
trigger1 = target(1200),alive
trigger1 = target(1200),statetype != A
trigger1 = movehit = 1
var(21) = 1

[State 0, pos]
type = parentvaradd
trigger1 = movecontact = 1
var(4) = 1

[State 0, pos]
type = parentvarset
trigger1 = !time
var(20) = 0
[State 0, hitvel]
type = parentvarset
trigger1 = movecontact || movereversed
trigger2 = time > 60
var(20) = 1
persistent = 0

;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[State 0, end]
type = varset
trigger1 = movehit = 1
var(49) = 1
ignorehitpause = 1
persistent = 0

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1

[State 0, end]
type = poweradd
trigger1 = var(49)
value = 80
ignorehitpause = 1
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, explod]
type = explod
triggerall = anim = 1210
trigger1 = movecontact = 1 || movereversed = 1
trigger2 = time > 60
anim = 7201
id = 7201
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
triggerall = anim = 1210
trigger1 = movecontact = 1 || movereversed = 1
trigger2 = time > 60
anim = 8201
id = 8201
pos = 0,0
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999

[State 0, hitvel]
type = posfreeze
trigger1 = (movecontact = [1, 11]) || (movereversed = [1, 11])

[State 0, hitvel]
type = changeanim
trigger1 = movecontact = 11 || movereversed = 11
trigger2 = time > 60
value = 9999
[State 0, hitvel]
type = statetypeset
trigger1 = anim = 9999
movetype = I

[State 0, hitvel]
type = velset
trigger1 = anim = 9999
x = 0
y = 0

[State 0, hitvel]
type = stopsnd
trigger1 = animelemtime(2) < 0 && root,movetype = H
channel = 7

[State 0, hitvel]
type = destroyself
trigger1 = anim = 9999 && !numtarget
trigger2 = animelemtime(2) < 0 && root,movetype = H

;---------------------------------------------------------------------------
;崩れ落ち(相手)
[Statedef 1260]
type = S
movetype = H
physics = N
ctrl = 0
velset = 0,0
sprpriority = 1

[State 0, end]
type = changeanim
trigger1 = time < 20
value = 5002

[State 0, end]
type = selfstate
trigger1 = statetype = A
value = 5030

[State 0, end]
type = changeanim2
trigger1 = time = 20
value = 1260

[State 0, end]
type = selfstate
trigger1 = anim = 1260
trigger1 = !animtime
value = 5110

;---------------------------------------------------------------------------
;引きずり込んで
[Statedef 1300]
type    = S
movetype= A
physics = N
poweradd= 50
velset = 0,0
anim = 1300
ctrl = 0
sprpriority = 1

[State 1000, atd]
type = attackdist
trigger1 = 1
value = 0

[State 0, snd]
type = varset
Trigger1 = !var(59)
trigger1 = !time
var(2) = ifelse(command="63214z",2,ifelse(command="63214y",1,0))

[State 0, end]
type = varadd
trigger1 = var(7)
trigger1 = time = 1
var(58) = -5

[State 0, nhb]
type = nothitby
trigger1 = helper(10000),stateno = [1360, 1370)
value = SCA

[State 1000, end]
type = ChangeState
trigger1 = time > 0
trigger1 = helper(10000),stateno = 10000
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;引きずり込んで(Stand)
[Statedef 1350]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2

;template---
[State 0, hitvel]
type = stopsnd
trigger1 = time = 0
channel = 7

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = (PrevStateNo = 10000)
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 1300)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 0, var]
type = varset
trigger1 = !time
var(7) = root,var(7)

[State 1000, atd]
type = attackdist
trigger1 = 1
value = 0

[State 0, var]
type = varset
trigger1 = !time
var(2) = root,var(2)

[State 0, var]
type = varset
trigger1 = !time
var(4) = 0

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 1300,0
channel = 0

[State 0, anim]
type = changeanim
trigger1 = !time
value = 1350

[State 0, btr]
type = bindtoroot
trigger1 = prevstateno = 10000
trigger1 = time <= 1
pos = 15, -15

[State 0, hitvel]
type = changeanim
trigger1 = pos y < 0
value = anim

[State 0, hitvel]
type = veladd
trigger1 = animelemtime(2) < 0
y = .6

[State 0, explod]
type = explod
trigger1 = animelemtime(2) = 0
anim = 417
id = 415
facing = 1
postype = p1
pos = 0,0
sprpriority = 2-(vel x>0)*2
ownpal = 1
removeongethit = 1
removetime = -1
bindtime = -1
scale = .5,.25
ignorehitpause = 0

[State 0, btr]
type = velset
trigger1 = animelemtime(1) = 0
x = 3
[State 0, btr]
type = velset
trigger1 = animelemtime(2) = 0
x = 4.5 + (var(7) > 0) * 4.5
y = 0
[State 0, btr]
type = posset
trigger1 = animelemtime(2) = 0
y = 0

[State 0, anim]
type = changeanim
trigger1 = animelemtime(2) >= 5
trigger1 = animelemtime(3) < 0
trigger1 = p2bodydist x < 20 + (var(7) > 0) * 20
value = 1350
elem = 3

[State 0, snd]
type = playsnd
trigger1 = anim = 1051
trigger1 = animelemtime(1) = 0
value = 3,8
persistent = 0

[State 0, explod]
type = explod
trigger1 = anim = 1051
trigger1 = animelemtime(2) = 0
anim = 111
facing = -1
postype = p1
pos = 0,-50
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = .5,.5
persistent = 0

[State 0, turn]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 2,6
channel = 2

[State 0, var]
type = removeexplod
trigger1 = animelemtime(3) = 0
id = 415

[State 0, var]
type = stopsnd
trigger1 = animelemtime(4) = 0
channel = 2

[State 0, hitvel]
type = velset
trigger1 = animelemtime(5) = 0
x = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(2) >= 0
trigger1 = !(time % 9)
anim = 8101
id = 8100
facing = 1
postype = p1
pos = 0,0
sprpriority = -1
ownpal = 1
removeongethit = 1
;removetime = -1
bindtime = -1
scale = .1,.25
ignorehitpause = 0

[State 0, hitvel]
type = velmul
trigger1 = animelemtime(4) >= 0
x = .82

[State 0, hitvel]
type = velset
trigger1 = animelemtime(5) = 4
x = 0

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 0, snd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 3,7

[State 0, hit]
type = hitdef
triggerall = (p2stateno != [40,42])
trigger1 = animelemtime(4) >= 0
trigger1 = animelemtime(5) < 0
attr = S, ST
damage = 0
priority = 1,hit;1,Miss
hitflag = M;AF
guardflag = -1
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0;13
sparkno = -1;s6002
sparkxy = -15,-70
guard.sparkno = s6010
hitsound = s1,0
guardsound = s9,0
getpower = 0,0
givepower = 0,0
ground.type = Low
ground.slidetime = 21
ground.hittime = 21
ground.velocity = -4,-5
guard.velocity = -5.5
guard.slidetime = 18
guard.hittime = 18
guard.ctrltime = 18
air.type = Low
air.velocity = -3,-4
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 18
fall = 1
fall.recover = 0
fall.recovertime = 0
air.fall = 1
guard.kill = 0
yaccel = .45
id = 1300
envshake.time = 20
envshake.freq = 55
envshake.ampl = -4
sprpriority = 1
p1stateno = 1360
p2stateno = 1370
p2facing = 1

[State 0, tar]
type = targetstate
;trigger1 = numtarget(1300)
trigger1 = movehit; = 1
value = 1370
;id = 1300

[State 0, var]
type = varset
trigger1 = movecontact = 1
var(4) = 1

[State 0, end]
type = varset
trigger1 = movecontact = 1
var(49) = 1
ignorehitpause = 1

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1

[State 0, end]
type = poweradd
trigger1 = var(49)
value = 80
ignorehitpause = 1
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
ignorehitpause = 1

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 7201
id = 7201
pos = 0,-10
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 8201
id = 8201
pos = 0,0
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !animtime
value = 12,1

[State 0, hitvel]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno = 3100 || root,stateno = 3200
value = 10000

;---------------------------------------------------------------------------
;スタンド追撃
[Statedef 1360]
type = S
movetype = A
physics = N
ctrl = 0
anim = 1360
velset = 0,0
poweradd = 0
sprpriority = 2

[State 0, var]
type = playsnd
trigger1 = time = 1
value = 1300, 10+random%2
channel = 0

[State 0, end]
type = null;bindtoroot
trigger1 = time < 2
pos = 40,0

[State 0, var]
type = screenbound
trigger1 = time < 3
value = 1

[State 0, var]
type = targetbind
trigger1 = 1
pos = 20,-15
id = 1300

[State 0, var]
type = playerpush
trigger1 = 1
value = 0
[State 0, var]
type = screenbound
trigger1 = time > 2
value = 0
movecamera = 1,0

[State 0, var]
type = posadd
trigger1 = time >= 13
y = 8

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 10,0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 0, end]
type = changestate
trigger1 = animelemtime(2) >= 5
value = 1361

;---------------------------------------------------------------------------
;HHA(スタンド追撃2)
[Statedef 1361]
type = S
movetype = A
physics = N
ctrl = 0
anim = 6051
velset = 0,0
poweradd = 0

[State 0, var]
type = posset
trigger1 = !time
y = 0

[State 0, var]
type = velset
trigger1 = time = 1
trigger2 = time = 18
trigger3 = time = 36
x = (rootdist x / 12)

[State 0, var]
type = velset
trigger1 = time = 9
trigger2 = time = 24
x = (rootdist x / 24) * -1

[State 0, var]
type = velmul
trigger1 = time >= 1
x = .9

[State 0, var]
type = targetbind
trigger1 = 1
pos = 0,0
id = 1300

[State 0, var]
type = playsnd
trigger1 = time < 44
trigger1 = !(time%9)
value = 2,7
channel = 2

[State 0, explod]
type = explod
trigger1 = !numexplod(415)
anim = 417
id = 415
facing = 1
postype = p1
pos = 0,0
sprpriority = 2-(vel x>0)*2
ownpal = 1
removeongethit = 1
removetime = -1
bindtime = -1
scale = .5,.25
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = time < 44
trigger1 = !(time%9)
anim = 3071
id = 3071
facing = 1
postype = p1
pos = 0,0
sprpriority = 2-(vel x>0)*2
ownpal = 1
scale = .25+(root,var(7)>0)*.15,.25+(root,var(7)>0)*.15
ignorehitpause = 0

[State 810, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = time < 44
trigger1 = !(time%9)
value = ceil(IfElse(var(7)>0, -13, -8)*(root,fvar(10)))
kill = 0
ID = 1300

[State 810, 掴んだ相手のライフ増減]
type = hitadd
trigger1 = time < 44
trigger1 = !(time%9)
value = 1

[State 810, hit]
type = varadd
trigger1 = time = 0;!(time%9)
var(13) = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, var]
type = removeexplod
trigger1 = time = 60
id = 415

[State 0, end]
type = changestate
trigger1 = time >= 60
value = 1362

;---------------------------------------------------------------------------
;スタンド追撃3
[Statedef 1362]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3062
velset = 0,0
poweradd = 0

;template---
[State 0, hitvel]
type = stopsnd
trigger1 = time = 0
channel = 7

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = (PrevStateNo = 10000)
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 1300)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 810, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = !time
value = ceil(IfElse(var(7)>0, -70, -52)*(root,fvar(10)))
kill = 1

[State 810, hit]
type = hitadd
trigger1 = !time
value = 1

[State 810, hit]
type = parentvaradd
trigger1 = !time
var(13) = 1

[State 0, var]
type = stopsnd
trigger1 = !time
channel = 2

[State 0, explod]
type = explod
trigger1 = !time
anim = 6003
pos = 30,-70
postype = p1
sprpriority = 3
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = !time
anim = 3065
id = 3065
pos = 30,0
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = posset
trigger1 = !time
y = 0

[State 0, var]
type = targetbind
trigger1 = !time
pos = 10,0
id = 1300

[State 0, var]
type = playsnd
trigger1 = !time
value = 6,3

[State 0, pos]
type = posadd
trigger1 = time = [1,6]
y = -9

[State 810, cancel]
type = varset
trigger1 = time = 6
var(4) = 1

[State 0, var]
type = velset
trigger1 = time = 16
x = 0
y = -8

[State 0, var]
type = velmul
trigger1 = time > 21
y = .86

[State 0, end]
type = targetstate
trigger1 = !time
value = 1371
id = 1300

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, explod]
type = explod
trigger1 = time = 59
anim = 7201
id = 7201
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = time = 59
anim = 8201
id = 8201
pos = 0,0
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = time = 89
value = 12,1

[State 0, end]
type = changestate
trigger1 = time >= 60
value = 10000

;---------------------------------------------------------------------------
;相手側１
[Statedef 1370]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 820, 相手のアニメ変更]
type = ChangeAnim
trigger1 = Time < 40
value = 5012

[State 820, 相手ステートに戻す]
type = SelfState
trigger1 = time = 300
value = 5050

[State 820, 相手ステートに戻す]
type = veladd
trigger1 = time >= 40
y = .5

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = time = 40
trigger1 = SelfAnimExist(5051)
value = 5051

[State 2601, ChangeAnim] ;Change anim when done with transition
type = ChangeAnim
trigger1 = time = 40
trigger1 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5050
persistent = 0

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = time >= 38
value = 5011

[State 5050, 2] ;Coming down anim
type = ChangeAnim2
trigger1 = time >= 18
value = 9999

[State 5050, 2] ;Coming down anim
type = selfstate
trigger1 = time >= 300
value = 5050

;---------------------------------------------------------------------------
;相手側１
[Statedef 1371]
type    = A
movetype= H
physics = N
velset = 0, 0
sprpriority = 0

[State 0, pos]
type = posadd
trigger1 = time = [1,6]
x = -1
y = -9

[State 0, pos]
type = posadd
trigger1 = time < 16
x = 1*ifelse(time%2=0,-1,1)

[State 0, var]
type = velset
trigger1 = time = 16
x = -4.5
y = -9.8

[State 2601, Pal]
type = PalFX
trigger1 = !time
time = 60
color= 32
sinadd = 10,30,60,8
mul = 128,256,512
time = 32

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = !time
trigger1 = SelfAnimExist(5051)
value = 5051

[State 2601, ChangeAnim] ;Change anim when done with transition
type = ChangeAnim
trigger1 = !time
value = 5030
persistent = 0

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = time = 30
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = time = 30
trigger1 = SelfAnimExist(anim+10)
value = 5050
persistent = 0

[State 0, var]
type = veladd
trigger1 = time > 16
y = .45

[State 0, var]
type = selfstate
trigger1 = time > 16
trigger1 = pos y >= 0 && vel y > 0
value = 5100

;---------------------------------------------------------------------------
;Specials
;---------------------------------------------------------------------------
;5B
[Statedef 2000]
type    = S
movetype= A
physics = N
poweradd= 0
velset = 0,0
anim = 1000
ctrl = 0
sprpriority = 1

[State 0, end]
type = varadd
trigger1 = var(7)
trigger1 = time = 1
var(58) = -5

[State 1000, end]
type = ChangeState
trigger1 = time > 0
trigger1 = helper(10000),stateno = 10000
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;5B(Stand)
[Statedef 2050]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2

;template---
[State 0, end]
type = varset
trigger1 = time = 0
var(8) = 0

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 2000)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template
[State 0, end]
type = varset
trigger1 = !time
var(4) = 0

[State 0, end]
type = varset
trigger1 = !time
var(7) = 0
[State 0, end]
type = varset
trigger1 = !time
trigger1 = root,var(7)
var(7) = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 2000,random%2
channel = 0

[State 0, anim]
type = changeanim
trigger1 = !time
value = 2050 + (var(7) = 1) * 5

[State 0, btr]
type = bindtoroot
trigger1 = time <= 1
pos = 15,0

[State 0, snd]
type = playsnd
trigger1 = animelemtime(1) = 0
value = 3,8
persistent = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(2) = 0
anim = 21001
id = 21001
facing = 1
postype = p1
pos = 0,-60
sprpriority = 3
ownpal = 1
bindtime = -1
removeongethit = 1
scale = .5, .5
persistent = 0
ignorehitpause = 0

;びりびり
[State 0, explod]
type = explod
trigger1 = animelemtime(2) = 0
anim = 21000
id = 21000
facing = 1
postype = p1
pos = 0,-55
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = .8, 1
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = !var(7)
trigger1 = animelemtime(4) < 0
trigger1 = time % 8 = 0
anim = 227
id = 227
facing = 1
postype = p1
pos = 0,-45-(random%20)
angle = random
sprpriority = 2
ownpal = 1
vel = 0,0
scale = .5,.5
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = var(7)
trigger1 = animelemtime(8) < 0
trigger1 = time % 4 = 0
anim = 227
id = 227
facing = 1
postype = p1
pos = 0,-45-(random%20)
angle = random
sprpriority = 2
ownpal = 1
vel = 0,0
scale = .5,.5
ignorehitpause = 0
[State 0, explod]
type = explod
trigger1 = var(7)
trigger1 = animelemtime(8) = 0
anim = 227
id = 227
facing = 1
postype = p1
pos = 0,-55
sprpriority = 2
ownpal = 1
vel = 0,0
scale = .75, .75
ignorehitpause = 0

[State 4550, 0]
type = ModifyExplod
trigger1 = numexplod(21000) > 0
scale = .8,1/(time*0.1)
id = 21000

[State 0, hitvel]
type = velset
trigger1 = anim = [2050, 2055]
trigger1 = animelemtime(2) = 1
x = 12

;バゴーン
[State 0, snd]
type = playsnd
trigger1 = animelemtime(2) = 1
value = 2010,0

[State 0, hitvel]
type = velmul
trigger1 = vel x
x = .95

[State 0, hitvel]
type = velset
trigger1 = !var(7)
trigger1 = animelem = 4
trigger2 = var(7)
trigger2 = animelem = 9
x = 0

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 200, ヒット定義]
type = HitDef
triggerall = !var(7)
trigger1 = AnimElem = 2
attr = S, SA
animtype  = diagup
damage    = ceil(73*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(73*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,16
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -6,-4.5 + root,fVar(20)
guard.velocity = -2
air.velocity = -6,-4.5 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 10,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32
sprpriority = 2

;MAX時
[State 200, ヒット定義]
type = HitDef
triggerall = var(7)
trigger1 = Animelemtime(2) = 0
trigger2 = Animelemtime(3) = 0
trigger3 = Animelemtime(4) = 0
trigger4 = Animelemtime(5) = 0
trigger5 = Animelemtime(6) = 0
attr = S, SA
animtype  = hard
damage = ceil(6*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(6*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,3
sparkno = s6000
guard.sparkno = s6040
sparkxy = -10,-55-(random%30)
hitsound   = s2,0
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -6
guard.velocity = -2
air.velocity = -3,-1.5 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 10,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
id = 1200
sprpriority = 2

[State 200, ヒット定義]
type = HitDef
triggerall = var(7)
trigger1 = Animelem = 8
attr = S, SA
animtype  = diagup
damage = ceil(30*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(30*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0, 24
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -4,-4.5 + root,fVar(20)
guard.velocity = -2
air.velocity = -6,-4.5 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 10,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
id = 1200
sprpriority = 2

[State 0, end]
type = varset
trigger1 = movecontact = 1
var(4) = 1

[State 0, anim]
type = changeanim
trigger1 = var(8) > 0
value = anim
elem = animelemno(-1)

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, var]
type = varset
trigger1 = !var(7)
trigger1 = movecontact = 1
var(8) = 16
ignorehitpause = 1
persistent = 0

[State 0, var]
type = varset
trigger1 = var(7)
trigger1 = movecontact = 1
trigger1 = Animelemtime(2) >= 0
trigger1 = Animelemtime(8) < 0
var(8) = 3
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = var(7)
trigger1 = movecontact = 1
trigger1 = AnimelemTime(8) >= 0
var(8) = 24
ignorehitpause = 1
persistent = 0

[State 0, var]
type = varadd
trigger1 = var(8)
var(8) = -1
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = movehit = 1
var(49) = 1
ignorehitpause = 1
;persistent = 0

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1
persistent = 0

[State 0, end]
type = poweradd
trigger1 = var(49)
value = ifelse(var(7),20,100)
;ignorehitpause = 1
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
;ignorehitpause = 1

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 7201
id = 7201
pos = 0,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 8201
id = 8201
pos = 0,-50
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !animtime
value = 12,1

[State 0, hitvel]
type = changestate
trigger1 = !animtime
value = 10000

;---------------------------------------------------------------------------
;2B
[Statedef 2100]
type    = S
movetype= A
physics = N
poweradd= 0
velset = 0,0
anim = 2100
ctrl = 0
sprpriority = 1

[State 0, end]
type = varadd
trigger1 = var(7)
trigger1 = time = 1
var(58) = -5

[State 1000, end]
type = ChangeState
trigger1 = time > 0
trigger1 = helper(10000),stateno = 10000
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;2B(Stand)
[Statedef 2150]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2

;template---
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 2100)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 0, var]
type = varset
trigger1 = time = 0
var(4) = 0

[State 0, end]
type = varset
trigger1 = !time
var(7) = 0
[State 0, end]
type = varset
trigger1 = !time
trigger1 = root,var(7)
var(7) = 1

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 2100,random%2
channel = 0

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, anim]
type = changeanim
trigger1 = !time
value = 2150+(var(7)>0)

[State 0, btr]
type = bindtoroot
trigger1 = animelemtime(9) < 0
pos = 45,0

[State 2601, Vel]
type = playerpush
trigger1 = 1
value = 0

[State 0, snd]
type = playsnd
trigger1 = animelemtime(9) = 0
value = 2,14
persistent = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(9) = 0
anim = 3108
id = 3108
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
scale = ifelse(var(7),1,.5),ifelse(var(7),1,.5)
removetime = 20
bindtime = -1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause=0
[State 0, explod]
type = explod
trigger1 = animelemtime(9) = 0
anim = 3109
id = 3109
pos = 30,0
vel = 1*ifelse(var(7),2,1),0
postype = p1
sprpriority = 2
ownpal = 1
scale = ifelse(var(7),.75,.5),ifelse(var(7),.75,.5)
facing = -1
removetime = 18
pausemovetime = 999999
supermovetime = 9999999
[State 0, explod]
type = explod
trigger1 = animelemtime(9) = 0
anim = 3109
id = 3109
pos = -30,0
vel = -.7*ifelse(var(7),2,1),0
postype = p1
sprpriority = 2
ownpal = 1
scale = ifelse(var(7),.75,.5),ifelse(var(7),.75,.5)
removetime = 18
pausemovetime = 999999
supermovetime = 9999999
;びりびり
[State 0, explod]
type = explod
trigger1 = animelemtime(9) = 0
anim = 2155
id = 2155
facing = 1
postype = p1
pos = 0,0
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = ifelse(var(7),1,.75),ifelse(var(7),1,.75)
bindtime = -1
persistent = 0
ignorehitpause = 0

;びりびり
[State 0, explod]
type = explod
trigger1 = animelemtime(9) = 0
anim = 2156
id = 2155
facing = 1
postype = p1
pos = 0,0
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = ifelse(var(7),1,.5),ifelse(var(7),1,.5)
bindtime = -1
persistent = 0
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(9) = 0
;trigger1 = time%ifelse(root,var(7),4,8) = 0
anim = 227
id = 227
facing = 1
postype = p1
pos = 0,-20
sprpriority = 2
ownpal = 1
vel = 0,0
scale = .75,.5
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(9) = 0
anim = 417
id = 415
facing = 1
postype = p1
pos = 0,0
sprpriority = 2
ownpal = 1
removeongethit = 1
removetime = 18
scale = ifelse(var(7),1,.5),.25
ignorehitpause = 0

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 200, ヒット定義]
type = HitDef
triggerall = !var(7)
trigger1 = AnimElemtime(9) >= 0
trigger1 = AnimElemtime(11) < 0
trigger1 = time % 3 = 0
attr = C, SP
animtype  = diagup
damage    = ceil(12*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(12*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,7
sparkno = -1;s6000
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = -1;s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -6,-3.5
guard.velocity = -2
air.velocity = -3,-5 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 15,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32
sprpriority = 2

;MAX時
[State 200, ヒット定義]
type = HitDef
triggerall = var(7)
trigger1 = AnimElemtime(9) >= 0
trigger1 = AnimElemtime(10) < 0
trigger1 = time % 3 = 0
attr = C, SP
animtype  = hard
damage    = ceil(12*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(12*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,3
sparkno = -1;s6000
guard.sparkno = s6040
sparkxy = -10,-55-(random%30)
hitsound   = -1;s2,0
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -6
guard.velocity = -2
air.velocity = -3,-5 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 15,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
sprpriority = 2
id = 2100

[State 200, ヒット定義]
type = HitDef
triggerall = var(7)
trigger1 = animelem = 10
attr = C, SP
animtype  = hard
damage    = ceil(15*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(15*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,9
sparkno = -1;s6000
guard.sparkno = s6040
sparkxy = -10,-55-(random%30)
hitsound   = -1;s2,0
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -6
guard.velocity = -2
air.velocity = -3,-5 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 15,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
sprpriority = 2
id = 2101

[State 0, var]
type = varset
trigger1 = animelemtime(10) >= 0
trigger1 = movecontact
var(4) = 1

;崩れ落ち
[State 0, pos]
type = targetstate
triggerall = !root,var(21)
trigger1 = numtarget(2101)
trigger1 = target(2101),alive
trigger1 = target(2101),statetype != A
trigger1 = movehit = 1
value = 1260
id = 2101

[State 0, pos]
type = parentvarset
triggerall = !root,var(21)
trigger1 = numtarget(2101)
trigger1 = target(2101),alive
trigger1 = target(2101),statetype != A
trigger1 = movehit = 3;1
var(21) = 1


;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[State 0, end]
type = varset
trigger1 = movehit = 1
var(49) = 1
ignorehitpause = 1
;persistent = 0

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1
persistent = 0

[State 0, end]
type = poweradd
trigger1 = var(49)
value = 30
;ignorehitpause = 1
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
;ignorehitpause = 1

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 7201
id = 7201
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 8201
id = 8201
pos = 0,-10
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !animtime
value = 12,1

[State 0, hitvel]
type = changestate
trigger1 = !animtime
value = 10000

;---------------------------------------------------------------------------
;ジャンプB
[Statedef 2200]
type    = A
movetype= A
physics = N
poweradd= 0
ctrl = 0
anim = 2200
sprpriority = 1

[State 0, end]
type = varadd
trigger1 = var(7)
trigger1 = time = 1
var(58) = -5

[State 200, 変数]
type = VarSet
trigger1 = !time
var(20)= ifelse(command="holdfwd",1,ifelse(command="holdback",-1,0))

[State 200, 変数]
type = velset
trigger1 = !time
y = .3

[State 200, 変数]
type = velmul
trigger1 = time < 18
x = .6

[State 200, 変数]
type = velset
trigger1 = time = 18
x = var(20)*2
y = -8

[State 200, 変数]
type = veladd
trigger1 = time >= 18
y = .4

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = time = 1
value = 2200,0+(random%2)
channel = 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 600, ステート変更]
type = changestate
trigger1 = time > 20
trigger1 = vel y >= 0 && pos y >= 0
value = 2252

;---------------------------------------------------------------------------
;JB(Stand)
[Statedef 2250]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2
velset = 0,6

;template---
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 2200)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 200, v]
type = VarSet
trigger1 = Time = 0
var(4)= 0

[State 200, v]
type = VarSet
trigger1 = Time = 0
var(8) = 0

[State 0, end]
type = varset
trigger1 = !time
var(7) = 0
[State 0, end]
type = varset
trigger1 = !time
trigger1 = root,var(7)
var(7) = 1

[State 0, anim]
type = changeanim
trigger1 = !time
value = 2250+(var(7)>0)

[State 0, btr]
type = bindtoroot
trigger1 = animelemtime(2) < 0
pos = 0,0

[State 2601, Vel]
type = playerpush
trigger1 = 1
value = 0

[State 0, snd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 2,5
channel = 7

[State 0, snd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 2,14
persistent = 0

[State 0, snd]
type = velmul
trigger1 = 1
y = .9

;びりびり
[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 2255
id = 2255
facing = 1
postype = p1
pos = 0,-30
sprpriority = 1
ownpal = 1
bindtime = -1
removeongethit = 1
removetime = 28+(var(7))*20
scale = ifelse(var(7),1,.75),ifelse(var(7),1,.75)
bindtime = -1
persistent = 0
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
;trigger1 = time%ifelse(root,var(7),4,8) = 0
anim = 227
id = 227
facing = 1
postype = p1
pos = 0,-20
removetime = 28+(var(7))*20
sprpriority = 2
ownpal = 1
vel = 0,0
scale = .75,.75
ignorehitpause = 0
[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
;trigger1 = time%ifelse(root,var(7),4,8) = 0
anim = 228
id = 228
facing = 1
postype = p1
pos = 0,-20
sprpriority = 2
removetime = 20+(var(7))*20
ownpal = 1
vel = 0,0
scale = .75,.75
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 417
id = 415
facing = 1
postype = p1
pos = 0,0
sprpriority = 2
ownpal = 1
removeongethit = 1
removetime = 26
scale = .5,.5
ignorehitpause = 0

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 0, turn]
type = turn
trigger1 = AnimElem = 3
trigger1 = P2Dist x < 0

[State 200, ヒット定義]
type = HitDef
triggerall = !var(7)
trigger1 = AnimElemtime(3) >= 0
trigger1 = AnimElemtime(4) < 0
trigger1 = time % 3 = 0
attr = A, SP
animtype  = hard
damage    = ceil(7*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(7*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,3
sparkno = -1;s6000
guard.sparkno = s6040
sparkxy = -10,10
hitsound   = -1;s2,2
guardsound = -1;s10,0
priority = 4, Hit
ground.type = high
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = 0,0
guard.velocity = -2
air.velocity = -3,-6 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 15,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 1
fall.recovertime = 23
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32
sprpriority = 2
p2facing = 1

[State 200, ヒット定義]
type = HitDef
triggerall = !var(7)
trigger1 = AnimElemtime(4) = 0
attr = A, SP
animtype  = hard
damage    = ceil(24*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(24*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,12
sparkno = s6012
guard.sparkno = s6040
sparkxy = -10,10
hitsound   = s2,7
guardsound = s10,0
priority = 4, Hit
ground.type = high
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3,-6
guard.velocity = -2
air.velocity = -3,-6 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 15,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
fall.recovertime = 23
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 10,30,60,8
palfx.mul = 128,256,512
palfx.time = 32
sprpriority = 2
p2facing = 1

[State 200, ヒット定義]
type = HitDef
triggerall = var(7)
trigger1 = AnimElemtime(3) >= 0
trigger1 = AnimElemtime(4) < 0
trigger1 = time % 3 = 0
attr = A, SP
animtype  = hard
damage    = ceil(4*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(4*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,3
sparkno = -1;s6000
guard.sparkno = s6040
sparkxy = -10,10
hitsound   = -1;s2,2
guardsound = -1;s10,0
priority = 4, Hit
ground.type = high
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = 0,0
guard.velocity = -2
air.velocity = -3,-6 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 15,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 1
fall.recovertime = 23
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
sprpriority = 2

[State 200, ヒット定義]
type = HitDef
triggerall = var(7)
trigger1 = AnimElemtime(4) = 0
attr = A, SP
animtype  = hard
damage    = ceil(4*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(4*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
guardflag = MA
pausetime = 0,16
sparkno = s6012
guard.sparkno = s6040
sparkxy = -10,10
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = high
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -3, -6*(root,var(21))
guard.velocity = -2
air.velocity = -3,-6 + root,fVar(20)
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 15,0
fall = (root,var(21))
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
fall.recovertime = 23
down.bounce = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
sprpriority = 2
id = 1251
p2facing = 1

[State 0, end]
type = varset
trigger1 = movecontact = 1
var(4) = 1
ignorehitpause = 1

[State 0, anim]
type = changeanim
trigger1 = var(8) > 0
value = anim
elem = animelemno(-1)

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, var]
type = varset
triggerall = !var(7)
trigger1 = AnimElemtime(4) >= 0
trigger1 = movecontact = 1
var(8) = 12
ignorehitpause = 1
persistent = 0

[State 0, var]
type = varset
triggerall = var(7)
trigger1 = AnimElemtime(4) >= 0
trigger1 = movecontact = 1
var(8) = 24
ignorehitpause = 1
persistent = 0

[State 0, var]
type = varadd
trigger1 = var(8)
var(8) = -1
ignorehitpause = 1

[State 0, pos]
type = targetstate
triggerall = !root,var(21)
trigger1 = numtarget(1251)
trigger1 = target(1251),alive
trigger1 = target(1251),statetype != A
trigger1 = movehit = 1
value = 1260
id = 1251

[State 0, pos]
type = parentvarset
triggerall = !root,var(21)
trigger1 = numtarget(1251)
trigger1 = target(1251),alive
trigger1 = target(1251),statetype != A
trigger1 = movehit = 1
var(21) = 1

[State 0, end]
type = varset
trigger1 = movehit = 1
var(49) = 1
ignorehitpause = 1
;persistent = 0

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1
persistent = 0

[State 0, end]
type = poweradd
trigger1 = var(49)
value = ifelse(var(7),10,20)
;ignorehitpause = 1
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
;ignorehitpause = 1

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 7201
id = 7201
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 8201
id = 8201
pos = 0,-10
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !animtime
value = 12,1

[State 0, hitvel]
type = stopsnd
trigger1 = !animtime
channel = 7

[State 0, hitvel]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno = 2252 && root,animtime = -1
value = 10000

;===========================================================================
;超必殺技
;===========================================================================
;小指(HHA)
[Statedef 3000]
type    = S
movetype= A
physics = N
poweradd= 0
velset = 0,0
anim = 3000
ctrl = 0
sprpriority = 1

[State 0, explod]
type = null
trigger1 = !time
trigger1 = 1||var(22):= 0
trigger2 = time = 1
trigger2 = !var(7) && var(58) < 49
trigger2 = 1||var(22):= 1

[State 0, explod]
type = varadd
trigger1 = var(22) = 1
trigger1 = !var(7) && var(58) < 49
var(58) = 1

;bg
[State 0, snd]
type = bgpalfx
trigger1 = !time
add = 255,255,255
time = 2
ignorehitpause = 1
[State 3000,03]
type = BGPalfx
trigger1 = time = [2,62]
mul = 168-time,168-time,128-time
time = 1
ignorehitpause = 1


[State 0, super]
type = superpause
trigger1 = time = 2
time = 60
movetime = 60
anim = -1
sound = s4,4
darken = 0
p2defmul = 1
poweradd = -1000
[State 0, explod]
type = explod
trigger1 = time = 2
anim = 7010
id = 7010
pos = 35,-70
postype = p1
sprpriority = 3
ownpal = 1
shadow = 0,0,0
bindtime = -1
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999

[State 3000,03]
type = BGPalfx
trigger1 = time = 1
mul = 128,128,128
time = 60
persistent = 0
ignorehitpause = 1

[State 0, end]
type = width
trigger1 = helper(10000),stateno = [3060,3061]
edge = 120,-120

[State 810, 音を鳴らす];掴み用
type = nothitby
trigger1 = time <= 72
trigger2 = helper(10000),stateno = [3060,3062]
value = SCA

[State 0, explod]
type = playsnd
trigger1 = helper(10000),stateno = 3061
trigger1 = helper(10000),time = 1
value = 3000,1
channel = 0

[State 0, explod]
type = playsnd
trigger1 = helper(10000),stateno = 3060
trigger1 = helper(10000),time = 1
value = 3010,0
channel = 1

[State 1000, ステート変更]
type = Changeanim
trigger1 = anim != 3001
trigger1 = time > 0
trigger1 = helper(10000),stateno = 10000
value = 3001

[State 1000, ステート変更]
type = ChangeState
trigger1 = anim = 3001
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;HHA(Stand)
[Statedef 3050]
type = U
movetype = A
physics = N
ctrl = 0
sprpriority = 2

;template---
[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
triggerall = !(root,stateno = 3000)
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 2000
trigger5 = root,stateno = 2100
trigger6 = root,stateno = 2200
trigger7 = root,stateno = 3000
trigger8 = root,stateno = 2200
value = root,stateno + 50
ignorehitpause = 1
[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time >= 1
trigger1 = (root,stateno = [200, 220]) || (root,stateno = 410)
value = root,stateno + 5
ignorehitpause = 1

;/template

[State 0, explod]
type = playsnd
trigger1 = !time
value = 3000,0
channel = 0
ignorehitpause = 1

[State 3001, Width]
type = changeanim
trigger1 = !time
value = 3050
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 12,0

[State 0, btr]
type = bindtoroot
trigger1 = time <= 1
pos = 30,0
ignorehitpause = 1

[State 810, 音を鳴らす];掴み用
type = nothitby
trigger1 = animelemtime(4) < 0
value = SCA
ignorehitpause = 1

[State 0, hitvel]
type = velset
trigger1 = animelemtime(2) = 0
x = 1
y = 2
ignorehitpause = 1

[State 0, hitvel]
type = velset
trigger1 = animelemtime(3) = 0
x = 6.5
y = 3.2
ignorehitpause = 1

[State 0, hitvel]
type = velmul
trigger1 = animelemtime(3) >= 0
x = .98
ignorehitpause = 1
[State 0, hitvel]
type = veladd
trigger1 = animelemtime(3) >= 0
trigger1 = animelemtime(3) < 10
y = -.9
ignorehitpause = 1

[State 0, hitvel]
type = velmul
trigger1 = animelemtime(2) >= 15
x = .6
y = .6
ignorehitpause = 1

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(13) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 0, hit]
type = hitdef
trigger1 = !root,var(7)
trigger1 = animelem = 2
attr = S, HA
damage    = ceil(25*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(25*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
priority = 7,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,16
sparkno = s6002
sparkxy = -15,-70
guard.sparkno = s6040
hitsound = s5,2
guardsound = s10,0
getpower = 0,0
givepower = 10,5
ground.type = low
ground.slidetime = 21
ground.hittime = 21
ground.velocity = 6,0
guard.velocity = -5.5
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
air.type = Low
air.velocity = 6,0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 18
fall = 1
fall.recover = 0
air.fall = 1
guard.kill = 0
yaccel = .458
id = 3050
sprpriority = 0
persistent = 0
kill = 0
p2facing = 1

[State 0, hit]
type = hitdef
trigger1 = root,var(7)
trigger1 = animelem = 2
attr = S, HA
damage    = ceil(50*root,fVar(10)),ceil(50*.20*root,fVar(10))
priority = 7,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,16
sparkno = s6002
sparkxy = -15,-70
guard.sparkno = s6040
hitsound = s5,2
guardsound = s10,0
getpower = 0,0
givepower = 10,5
ground.type = low
ground.slidetime = 21
ground.hittime = 21
ground.velocity = 6,0
guard.velocity = -5.5
guard.slidetime = 17
guard.hittime = 17
guard.ctrltime = 17
air.type = Low
air.velocity = 6,0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 18
fall = 1
fall.recover = 0
air.fall = 1
guard.kill = 0
yaccel = .458
id = 3050
sprpriority = 0
persistent = 0
kill = 0
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32
p2facing = 1

[State 0, pos]
type = targetstate
trigger1 = numtarget(3050)
trigger1 = movehit = 1
value = 3070
id = 3050

[State 0, pos]
type = changestate
triggerall = root,stateno = 3000
trigger1 = numtarget(3050)
trigger1 = target(3050),stateno = 3070
value = 3060

[State 0, end]
type = varset
trigger1 = movehit = 1
var(49) = 1
ignorehitpause = 1

[State 0, end]
type = parentvaradd
trigger1 = var(49)
var(13) = 1
ignorehitpause = 1

[State 0, end]
type = poweradd
trigger1 = var(49)
value = 0
ignorehitpause = 1
[State 0, end]
type = varset
trigger1 = var(49)
var(49) = 0
ignorehitpause = 1

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 7201
id = 7201
pos = 0,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = animtime = -1
anim = 8201
id = 8201
pos = 0,-50
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = !animtime
value = 12,1

[State 0, hitvel]
type = changestate
trigger1 = !animtime
value = 10000

;---------------------------------------------------------------------------
;HHA(スタンド追撃)
[Statedef 3060]
type = S
movetype = A
physics = N
ctrl = 0
anim = 3060
velset = 0,0
poweradd = 0
sprpriority = 2

;背景処理
[State 750, helper]
type = Helper
trigger1 = !time
helpertype = normal
name = "bgef"
ID = 6666
pos = 0,-220
postype = back
facing = 1
stateno = 6666
keyctrl = 0
ownpal = 1
size.xscale = 3
size.yscale = 3
supermovetime = 99999
pausemovetime = 99999

[State 0, end]
type = null;bindtoroot
trigger1 = time < 2
pos = 40,0

[State 0, end]
type = width
trigger1 = time < 3
edge = 80,-80

[State 0, var]
type = screenbound
trigger1 = time < 3
value = 1

[State 0, var]
type = targetbind
trigger1 = time < 40
pos = 20,-40
id = 3050

[State 0, var]
type = targetvelset
trigger1 = time = 40
y = -5
id = 3050

[State 0, var]
type = targetbind
trigger1 = animelemtime(2) >= 0
pos = 20,-15
id = 3050

[State 0, var]
type = playerpush
trigger1 = 1
value = 0
[State 0, var]
type = screenbound
trigger1 = time > 2
value = 0
movecamera = 1,0

[State 0, var]
type = posadd
trigger1 = animelemtime(2) >= 3
trigger1 = animelemtime(3) < 0
y = 8

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = prevstateno = 10000
value = 10,0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 0, var]
type = changeanim
trigger1 = time < 40
value = anim

[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 8201
id = 8201
pos = 0,-60
postype = p1
sprpriority = 1
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 8201
id = 8201
pos = 20,-60
postype = p1
sprpriority = 1
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 12,1

[State 0, end]
type = changestate
trigger1 = animelemtime(3) >= 5
value = 3061

;---------------------------------------------------------------------------
;HHA(スタンド追撃2)
[Statedef 3061]
type = S
movetype = A
physics = N
ctrl = 0
anim = 6051
velset = 0,0
poweradd = 0

[State 0, var]
type = posset
trigger1 = !time
y = 0

[State 0, var]
type = bindtoroot
trigger1 = !time
pos = 100,0

[State 0, var]
type = targetbind
trigger1 = 1
pos = 0,0
id = 3050

[State 0, var]
type = playsnd
trigger1 = time = 5
value = 2,5
channel = 2

[State 0, var]
type = velset
trigger1 = time = 5
x = -5
y = 2
[State 0, var]
type = velset
trigger1 = time = 45
x = 5
y = -2
[State 0, var]
type = velset
trigger1 = time = 85
x = -5
y = 2
[State 0, var]
type = velset
trigger1 = time = 125
x = 5
y = -2

[State 0, var]
type = removeexplod
trigger1 = time = 5
trigger2 = time = 45
trigger3 = time = 85
trigger4 = time = 125
id = 415

[State 0, explod]
type = explod
trigger1 = !numexplod(415)
anim = 417
id = 415
facing = 1
postype = p1
pos = 0,0
sprpriority = 2-(vel x>0)*2
ownpal = 1
removeongethit = 1
removetime = -1
bindtime = -1
scale = .5,.25
ignorehitpause = 0

[State 0, explod]
type = explod
trigger1 = !(time%6)
anim = 3071
id = 3071
facing = 1
postype = p1
pos = 0,0
sprpriority = 2-(vel x>0)*2
ownpal = 1
scale = .25+(root,var(7)>0)*.20,.25+(root,var(7)>0)*.20
ignorehitpause = 0

[State 810, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = !(time%6)
value = ceil(-3*(1+(root,var(7)>0)*.5)*(root,fvar(10)))
kill = 0

[State 810, 掴んだ相手のライフ増減]
type = hitadd
trigger1 = !(time%6)
value = 1

[State 810, 掴んだ相手のライフ増減]
type = varadd
trigger1 = !(time%6)
var(13) = 1

[State 0, var]
type = velmul
trigger1 = time = [35,44]
trigger2 = time = [75,84]
trigger3 = time = [115,124]
x = .8

[State 0, var]
type = velmul
trigger1 = time = [145,149]
x = .6

[State 0, var]
type = veladd
trigger1 = time >= 5
y = ifelse(pos y >= 0,-.1,.1+(time>130)*.1)

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, var]
type = removeexplod
trigger1 = time = 148
id = 415

[State 0, end]
type = changestate
trigger1 = time >= 148
value = 3062

;---------------------------------------------------------------------------
;HHA(スタンド追撃3)
[Statedef 3062]
type = A
movetype = A
physics = N
ctrl = 0
anim = 3062
velset = 0,0
poweradd = 0

[State 810, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = !time
value = ceil(IfElse(var(7), -110, -90)*(1+(root,var(7)>0)*.5)*(root,fvar(10)))
kill = 1

[State 810, 掴んだ相手のライフ増減]
type = hitadd
trigger1 = !time
value = 1

[State 810, 掴んだ相手のライフ増減]
type = varadd
trigger1 = !time
var(13) = 1

[State 0, var]
type = stopsnd
trigger1 = !time
channel = 2

[State 0, var]
type = posset
trigger1 = !time
y = 0

[State 0, var]
type = targetbind
trigger1 = !time
pos = 20,0
id = 3050

[State 0, var]
type = playsnd
trigger1 = !time
value = 6,4

[State 0, explod]
type = explod
trigger1 = !time
anim = 6008
id = 6002
pos = 30,-70
postype = p1
sprpriority = 3
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = !time
anim = 3065
id = 3065
pos = 30,0
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = velset
trigger1 = !time
x = 2
y = -7

[State 0, var]
type = velmul
trigger1 = time > 5
x = .86
y = .86

[State 0, end]
type = targetstate
trigger1 = !time
value = 3071
id = 3050

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, explod]
type = explod
trigger1 = time = 89
anim = 7201
id = 7201
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = time = 89
anim = 8201
id = 8201
pos = 0,0
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999
[State 0, snd]
type = playsnd
trigger1 = time = 89
value = 12,1

[State 0, end]
type = changestate
trigger1 = time >= 90
value = 10000

;---------------------------------------------------------------------------
;相手側１
[Statedef 3070]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 820, 相手のアニメ変更]
type = ChangeAnim
trigger1 = Time < 40
value = 5012

[State 820, 相手ステートに戻す]
type = SelfState
trigger1 = time = 300
value = 5050

[State 820, 相手ステートに戻す]
type = veladd
trigger1 = time >= 40
y = .5

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = time = 40
trigger1 = SelfAnimExist(5051)
value = 5051

[State 2601, ChangeAnim] ;Change anim when done with transition
type = ChangeAnim
trigger1 = time = 40
trigger1 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5050
persistent = 0

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = time >= 45
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = time >= 58
value = 5011

[State 5050, 2] ;Coming down anim
type = ChangeAnim2
trigger1 = time >= 69
value = 9999

[State 5050, 2] ;Coming down anim
type = selfstate
trigger1 = time >= 300
value = 5050

;---------------------------------------------------------------------------
;相手側１
[Statedef 3071]
type    = A
movetype= H
physics = N
velset = -4,-6.8
sprpriority = 0

[State 2601, Pal]
type = PalFX
trigger1 = !time
time = 100
mul = 206,206,0
sinadd = 96,96,32,8

[State 2601, ChangeAnim] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = !time
trigger1 = SelfAnimExist(5051)
value = 5051

[State 2601, ChangeAnim] ;Change anim when done with transition
type = ChangeAnim
trigger1 = !time
value = 5030
persistent = 0

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = time = 60
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = time = 60
trigger1 = SelfAnimExist(anim+10)
value = 5050
persistent = 0

[State 0, var]
type = velmul
trigger1 = time = (5,30]
x = .86
y = .86

[State 0, var]
type = velset
trigger1 = time = 60
x = -6
y = -4

[State 0, var]
type = veladd
trigger1 = time >= 60
y = .45

[State 0, var]
type = selfstate
trigger1 = pos y >= 0 && vel y > 0
value = 5100

;---------------------------------------------------------------------------
;ギター(GHA)
[Statedef 3100]
type    = S
movetype= A
physics = N
poweradd= 0
velset = 0,0
anim = 3100
ctrl = 0
sprpriority = 1

[State 0, explod]
type = null
trigger1 = !time
trigger1 = 1||var(22):= 0
trigger2 = time = 1
trigger2 = !var(7) && var(58) < 49
trigger2 = 1||var(22):= 1

[State 0, explod]
type = varadd
trigger1 = var(22) = 1
trigger1 = !var(7) && var(58) < 49
var(58) = 1

;bg
[State 0, snd]
type = bgpalfx
trigger1 = !time
add = 255,255,255
time = 2
ignorehitpause = 1

[State 0, super]
type = superpause
trigger1 = time = 2
time = 60
movetime = 60
anim = -1
sound = -1;s0,21
darken = 0
p2defmul = 1
poweradd = -3000
;ピキーン
[State 0, snd]
type = playsnd
trigger1 = time = 2
value = 31000,0
[State 0, explod]
type = explod
trigger1 = time = 2
anim = 7000
id = 7000
pos = 0,-60
postype = p1
sprpriority = -8
ownpal = 1
shadow = 0,0,0
bindtime = -1
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = time = 2
anim = 7001
id = 7001
pos = 0,0
postype = L
bindtime = -1
sprpriority = -10
removetime = -1
ownpal = 1
shadow = 0,0,0
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999

[State 3000,03]
type = BGPalfx
trigger1 = time >= 2
mul = 168-time*2,168-time*2,128-time*2
time = 1
ignorehitpause = 1

;ピキーン
[State 0, snd]
type = playsnd
trigger1 = time = 2
value = 10001,93
channel = 7

;バゴーン
[State 0, snd]
type = playsnd
trigger1 = time = 68
value = 6,4

;雷
[State 0, explod]
type = explod
trigger1 = time = 68
anim = 3107
id = 3107
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
scale = 1,1
removetime = 12
pausemovetime = 999999
supermovetime = 999999
ignorehitpause=0
[State 0, explod]
type = explod
trigger1 = time = 68
anim = 3108
id = 3108
pos = 0,0
postype = p1
sprpriority = 2
ownpal = 1
scale = 1,1
removetime = 12
pausemovetime = 999999
supermovetime = 999999
ignorehitpause=0
[State 0, explod]
type = explod
trigger1 = time = 80
anim = 3109
id = 3109
pos = 60,0
vel = 1,0
postype = p1
sprpriority = 2
ownpal = 1
scale = 1,1
facing = -1
removetime = 12
pausemovetime = 999999
supermovetime = 9999999
[State 0, explod]
type = explod
trigger1 = time = 80
anim = 3109
id = 3109
pos = -60,0
vel = -1,0
postype = p1
sprpriority = 2
ownpal = 1
scale = 1,1
removetime = 12
pausemovetime = 999999
supermovetime = 9999999
[State 0, explod]
type = explod
trigger1 = time = 80
anim = 3109
id = 3109
pos = 30,0
postype = p1
sprpriority = 2
ownpal = 1
scale = 1.2,1
vel = 1,0
removetime = 12
pausemovetime = 999999
supermovetime = 999999

;煙
[State 0, explod]
type = explod
trigger1 = time = 68
anim = 3106
id = 3105
pos = 0,0
postype = p1
sprpriority = -2
ownpal = 1
scale = 1,1
pausemovetime = 999999
supermovetime = 999999
;煙side
[State 0, explod]
type = explod
trigger1 = time = 68
anim = 3105
id = 3105
pos = 0,0
postype = p1
sprpriority = -2
ownpal = 1
scale = 1,1
pausemovetime = 999999
supermovetime = 999999
[State 0, explod]
type = explod
trigger1 = time = 68
anim = 3105
id = 3105
pos = 0,0
postype = p1
sprpriority = -2
ownpal = 1
facing = -1
scale = 1,1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time >= 68
trigger1 = time < 76
anim = 3120
id = 3120
pos = -35+random%70,-35-random%70
postype = p1
vel = -3+(random%6),-.5
sprpriority = -2
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999

[State 810, 音を鳴らす];掴み用
type = nothitby
trigger1 = time < 70
value = SCA

[State 0, explod]
type = playsnd
trigger1 = !time
value = 3100,random%2
channel = 0

;atk
[State 1000, ステート変更]
type = Changeanim
trigger1 = time = 68
value = 3101

[State 200, ヒット定義]
type = HitDef
trigger1 = anim = 3101
trigger1 = animelem = 1
attr = S, HA
animtype  = diagup
damage    = ceil(40*(1+(var(7)>0)*.5)*fVar(10)),ceil(40*(1+(var(7)>0)*.5)*.20*fVar(10))
guardflag = MA
pausetime = 34,0
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-70
hitsound   = -1;s2,2
guardsound = s10,0
priority = 7, Hit
ground.type = low
ground.slidetime = 15
ground.hittime  = 15
guard.slidetime = 14
guard.hittime = 13
guard.ctrltime = 13
ground.velocity = -4,-6
guard.velocity = -2
air.velocity = -4,-6
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0,0
givepower = 0,0
fall = 1
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -6
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 80
sprpriority = 2
id = 3100
kill = 0

[State 1000, ステート変更]
type = targetstate
trigger1 = numtarget(3100)
trigger1 = movehit = 1
trigger1 = target(3100),movetype = H
value = 3120
ignorehitpause=1
id = 3100
[State 1000, ステート変更]
type = Changestate
trigger1 = numtarget(3100)
trigger1 = movehit = 1
trigger1 = target(3100),stateno = 3120
value = 3110

[State 1000, ステート変更]
type = Changestate
trigger1 = time >= 110
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;GHA(Succse)
[Statedef 3110]
type    = S
movetype= A
physics = N
velset = 0,0
;anim = 3110
ctrl = 0
sprpriority = 1

[State 30500, flag]
Type = AssertSpecial
Trigger1 = 1
flag = TimerFreeze

[State 1000, ステート変更]
type = playsnd
trigger1 = !time
value = s10001,94
channel = 4

[State 1000, ステート変更]
type = null;targetbind
trigger1 = !time
pos = 60,0
ignorehitpause=1
persistent = 0
id = 3100

[State 810, 音を鳴らす];掴み用
type = nothitby
trigger1 = 1
value = SCA

[State 3000,03]
type = BGPalfx
trigger1 = !time
mul = 0,0,0
time = 999
ignorehitpause = 1

[State 1000, ステート変更]
type = null;pause
trigger1 = time = [20,60]
time = 1
movetime = 1

;召喚（だみー）
[State 0, explod]
type = helper
trigger1 = time = 40
trigger2 = time = 52
trigger3 = time = 57
trigger4 = time = 62
trigger5 = time = 67
trigger6 = time = 72
trigger7 = time = 76
trigger8 = time = 82
stateno = 3132
id = 3130
facing = 1
postype = p1
pos = -40-random%30,-172-random%30
size.xscale = .75
size.yscale = .75
pausemovetime = 999
supermovetime = 999
ownpal = 1

;召喚
[State 0, explod]
type = helper
trigger1 = time = 40
trigger2 = time = 54
trigger3 = time = 68
trigger4 = time = 78
stateno = 3130
id = 3130
facing = 1
postype = p1
pos = -40-random%30,-172-random%30
size.xscale = .75
size.yscale = .75
pausemovetime = 999
supermovetime = 999
ownpal = 1

;召喚
[State 0, explod]
type = helper
trigger1 = time = 40
trigger2 = time = 54
trigger3 = time = 68
trigger4 = time = 88
stateno = 3130
id = 3130
facing = 1
postype = p1
pos = -46-random%30,-162-random%30
size.xscale = .75
size.yscale = .75
pausemovetime = 999
supermovetime = 999
ownpal = 1

;召喚
[State 0, explod]
type = helper
trigger1 = time = 52
trigger2 = time = 66
trigger3 = time = 84
stateno = 3130
id = 3130
facing = 1
postype = p1
pos = -60-random%30,-160-random%30
size.xscale = .65
size.yscale = .65
pausemovetime = 999
supermovetime = 999
ownpal = 1

;召喚
[State 0, explod]
type = helper
trigger1 = time = 42
trigger2 = time = 66
trigger3 = time = 90
stateno = 3130
id = 3130
facing = 1
postype = p1
pos = -50-random%30,-150-random%30
size.xscale = .75
size.yscale = .75
pausemovetime = 999
supermovetime = 999
ownpal = 1

;召喚
[State 0, explod]
type = helper
trigger1 = time = 72
trigger2 = time = 86
trigger3 = time = 92
stateno = 3130
id = 3130
facing = 1
postype = p1
pos = -50-random%30,-150-random%30
size.xscale = .85
size.yscale = .85
pausemovetime = 999
supermovetime = 999
ownpal = 1
;召喚
[State 0, explod]
type = helper
trigger1 = time = 76
trigger2 = time = 90
stateno = 3130
id = 3130
facing = 1
postype = p1
pos = -60-random%30,-150-random%30
size.xscale = .75
size.yscale = .75
pausemovetime = 999
supermovetime = 999
ownpal = 1

;召喚(〆)
[State 0, explod]
type = helper
trigger1 = time = 110
stateno = 3131
id = 3131
facing = 1
postype = p1
pos = -100,-260
size.xscale = 4
size.yscale = 4
pausemovetime = 999
supermovetime = 999
ownpal = 1

[State 1000, ステート変更]
type = playsnd
trigger1 = time = 40
value = s3100,10+random%2

[State 3000,03]
type = BGPalfx
trigger1 = time = 260
mul = 0,0,0
time = 1
ignorehitpause = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = time > 260
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ギター
[Statedef 3130]
type = A
movetype = A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2
anim = 3110

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 3020]
type = PalFX
trigger1 = animelemtime(4) = 0
time = 3
add = 255,255,255

[State 0, vel]
type = velset
trigger1 = !time
x = -.5
y = -.3

[State 0, vel]
type = velset
trigger1 = animelemtime(6) = 0
x = 12
y = 10

[State 1000, ステート変更]
type = parentvarset
trigger1 = animelemtime(6) = 0
var(16) = 1

[State 0, hit]
type = hitdef
trigger1 = animelem = 6
attr = A, HP
damage = ceil(11*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(11*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
priority = 5,Hit
hitflag = MAFD
guardflag = MA
animtype = medium
air.animtype = Back
fall.animtype = Back
pausetime = 5,6
guard.pausetime = 0,5
sparkno = s6000+random%3
sparkxy = 0,0
guard.sparkno = s6010
hitsound = -1;s5,5
guardsound = -1;s0,9
getpower = 0,0
givepower = 0,0
ground.type = low
ground.slidetime = 12
ground.hittime = 12
guard.slidetime = 15
guard.hittime = 15
guard.ctrltime = 15
ground.velocity = -6
guard.velocity = -5.5
air.velocity = -3,6
airguard.velocity = -3,-3
Down.Velocity = 0,0
air.type = low
air.hittime = 12
fall = 1
air.fall = 1
fall.recover = 0
guard.kill = 0
yaccel = .4
persistent = 0
p2facing = 1
NumHits = 3
id = 3110
kill = 0

[State 1000, ステート変更]
type = parentvarset
trigger1 = movecontact = 1
var(15) = 1
persistent = 0
ignorehitpause = 1

[State 1100, ステート変更]
type = targetstate
trigger1 = numtarget(3110)
trigger1 = movehit >= 1
trigger1 = target(3110),statetype = L
value = 3121
id = 3110
persistent = 0
ignorehitpause = 1

[State 0, end]
type = DestroySelf
trigger1 = pos y > 100

;---------------------------------------------------------------------------
;ギター(〆)
[Statedef 3131]
type = A
movetype = A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2
anim = 3111

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 3020]
type = PalFX
trigger1 = animelemtime(4) = 0
time = 3
add = 255,255,255

[State 0, vel]
type = velset
trigger1 = animelemtime(6) = 0
x = 16
y = 14

[State 0, vel]
type = velset
trigger1 = pos y > 0
x = 0
y = 0
ignorehitpause = 1

[State 0, shake]
type = envshake
trigger1 = pos y > 0
time = 10
freq = 90
ampl = -15
phase = 0
persistent = 0
ignorehitpause = 1

[State 0, end]
type = changeanim
trigger1 = anim != 3115
trigger1 = pos y > 0
value = 3115
ignorehitpause = 1

[State 5150, 8]
type = playsnd
trigger1 = anim = 3115
trigger1 = animelemtime(1) = 0
value = s3,6
ignorehitpause = 1

[State 0, hit]
type = hitdef
trigger1 = anim = 3115
attr = A, HP
damage = ceil(125*(1+(root,var(7)>0)*.5)*root,fVar(10)),ceil(125*(1+(root,var(7)>0)*.5)*.20*root,fVar(10))
priority = 5,Hit
hitflag = MAFD
guardflag = MA
animtype = medium
air.animtype = Back
fall.animtype = Back
pausetime = 30,30
sparkno = s6003
sparkxy = 0,0
guard.sparkno = s6010
hitsound = -1;s5,5
guardsound = -1;s0,9
getpower = 0,0
givepower = 0,0
ground.type = low
ground.slidetime = 12
ground.hittime = 12
guard.slidetime = 15
guard.hittime = 15
guard.ctrltime = 15
ground.velocity = -6
guard.velocity = -5.5
air.velocity = -3,-1*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
airguard.velocity = -3,-3
Down.Velocity = -1,-7
air.type = low
air.hittime = 12
fall = 1
air.fall = 1
fall.recover = 0
guard.kill = 0
yaccel = .4
persistent = 0
p2facing = 1
kill = 1

[State 0, end]
type = DestroySelf
trigger1 = anim = 3115 && !animtime

;---------------------------------------------------------------------------
;ギター(ダミー)
[Statedef 3132]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2
anim = 3110

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 3020]
type = PalFX
trigger1 = animelemtime(4) = 0
time = 3
add = 255,255,255

[State 0, vel]
type = velset
trigger1 = !time
x = -.5
y = -.3

[State 0, vel]
type = velset
trigger1 = animelemtime(6) = 0
x = 12+(random%10-5)
y = 10+(random%10-5)

[State 0, end]
type = DestroySelf
trigger1 = pos y > 100

;---------------------------------------------------------------------------
;GHA(enemy)
[Statedef 3120]
type = A
movetype = H
physics  = N
ctrl = 0
facep2 = 1
poweradd = 0
velset = 0,0
sprpriority = -1

[State 0, end]
type = hitby
trigger1 = 1
value = SCA,HP

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 0, end]
type = changeanim
trigger1 = time < 18
value = 5012

[State 0, end]
type = changeanim
trigger1 = ifelse(selfanimexist(5900),time=18,time>=18)
value = ifelse(selfanimexist(5900),5900,5050)

[State 0, end]
type = velset
trigger1 = time = 18
x = -5
y = -4.3

[State 0, pos]
type = null;posadd
trigger1 = time < 18
x = 1*ifelse(time%2=0,-1,1)

[State 0, end]
type = changeanim
trigger1 = time < 18
value = anim
elem = animelemno(0)

[State 0, pos]
type = velmul
trigger1 = time > 18
x = .92
y = .95*(ifelse(pos y < -100,.8,1))

[State 0, pos]
type = null;veladd
trigger1 = time > 18
y = .15

[State 0, pos]
type = selfstate
trigger1 = time > 76
trigger1 = pos y >= 0
value = 5100

[State 0, pos]
type = selfstate
trigger1 = time > 600
value = 5050

;---------------------------------------------------------------------------
;(相手)
[Statedef 3121]
type    = L
movetype= H
physics = S
anim = 5080
ctrl = 0

[state -2]
type = DefenceMulSet
trigger1 = 1
value = 1.0

[State 5080, 1] ;Set default anim
type = posset
trigger1 = time = 0
y = 0

[State 5080, 1] ;Set default anim
type = velset
trigger1 = time = 0
y = 0

[State 5080, 1] ;Set default anim
type = VarSet
trigger1 = time = 0
sysvar(2) = ifelse (GetHitVar(yvel) = 0, 5080, 5090)

[State 5080, 2]
type = VarAdd
trigger1 = time = 0
trigger1 = (anim = [5081,5089]) || (anim = [5111,5119])
trigger1 = SelfAnimExist(sysvar(2) + (anim % 10))
sysvar(2) = anim % 10

[State 5080, 3] ;If 5090 doesn't exist, default to 5030
type = VarSet
trigger1 = time = 0
trigger1 = sysvar(2) = 5090
trigger1 = !SelfAnimExist(5090)
sysvar(2) = 5030

[State 5080, 3] ;Freeze
type = ChangeAnim
trigger1 = 1
value = sysvar(2)

[State 5080, 4]
type = ChangeState
trigger1 = HitShakeOver
;trigger1 = GetHitVar(yvel) = 0
value = 3122 ;HITL_SLIDE

[State 5080, 5]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) != 0
value = 5030 ;HITA_UP

;---------------------------------------------------------------------------
; HITL_SLIDE
[Statedef 3122]
type    = L
movetype= H
physics = C

[state -2]
type = DefenceMulSet
trigger1 = 1
value = 1.0

[State 5081, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5081, 2]
type = VelSet
trigger1 = HitOver
x = 0

[State 5081, 3] ;Don't show hit ground frame
type = VarSet
trigger1 = Time = 0
sysvar(0) = 1

[State 5081, 4]
type = selfState
trigger1 = time > 60
trigger1 = HitOver
value = 5081 ;HIT_LIEDOWN

;---------------------------------------------------------------------------
;GHA(enemy)
[Statedef 3120]
type = A
movetype = H
physics  = N
ctrl = 0
facep2 = 1
poweradd = 0
velset = 0,0
sprpriority = -1

[State 0, end]
type = hitby
trigger1 = 1
value = SCA,HP

[State 0, end]
type = changeanim
trigger1 = time < 18
value = 5012

[State 0, end]
type = changeanim
trigger1 = ifelse(selfanimexist(5900),time=18,time>=18)
value = ifelse(selfanimexist(5900),5900,5050)

[State 0, end]
type = velset
trigger1 = time = 18
x = -1
y = -6

[State 0, pos]
type = null;posadd
trigger1 = time < 18
x = 1*ifelse(time%2=0,-1,1)

[State 0, end]
type = changeanim
trigger1 = time < 18
value = anim
elem = animelemno(0)

[State 0, pos]
type = veladd
trigger1 = time > 18
y = .15

[State 0, pos]
type = selfstate
trigger1 = time > 76
trigger1 = pos y >= 0
value = 5100

;---------------------------------------------------------------------------
;HHA2
[Statedef 3200]
type    = S
movetype= A
physics = N
poweradd= 0
velset = 0,0
anim = 3200
ctrl = 0
sprpriority = 1

[State 0, explod]
type = null
trigger1 = !time
trigger1 = 1||var(22):= 0
trigger2 = time = 1
trigger2 = !var(7) && var(58) < 49
trigger2 = 1||var(22):= 1

[State 0, explod]
type = varadd
trigger1 = var(22) = 1
trigger1 = !var(7) && var(58) < 49
var(58) = 1

[State 0, pos]
type = posadd
trigger1 = animelemtime(2) = 0
x = 5
[State 0, pos]
type = posadd
trigger1 = animelemtime(3) = 0
x = 11


;bg
[State 0, snd]
type = bgpalfx
trigger1 = !time
add = 255,255,255
time = 2
ignorehitpause = 1
[State 3000,03]
type = BGPalfx
trigger1 = time = [2,62]
mul = 168-time,168-time,128-time
time = 1
ignorehitpause = 1


[State 0, super]
type = superpause
trigger1 = time = 2
time = 60
movetime = 60
anim = -1
sound = s4,4
darken = 0
p2defmul = 1
poweradd = -1000
[State 0, explod]
type = explod
trigger1 = time = 2
anim = 7010
id = 7010
pos = -35,-70
postype = p1
sprpriority = 3
ownpal = 1
shadow = 0,0,0
bindtime = -1
scale = .5,.5
pausemovetime = 999999
supermovetime = 999999

[State 2601, EnvShake]
type = EnvShake
trigger1 = animelemtime(3) = 0
time = 10
ampl = 2

[State 0, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 3201
id = 3201
facing = 1
postype = p1
pos = 80,5
sprpriority = -1
ownpal = 1
scale = .35, .5

[State 3000,03]
type = BGPalfx
trigger1 = time = 1
mul = 128,128,128
time = 60
persistent = 0
ignorehitpause = 1

[State 810, 音を鳴らす];掴み用
type = nothitby
trigger1 = time <= 72
value = SCA

[State 0, explod]
type = playsnd
trigger1 = time = 1
value = 3200,0 + (Random%2)
channel = 0

[State 0, explod]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 3,6
channel = 1

[State 200, ヒット定義]
type = HitDef
trigger1 = !movecontact
trigger1 = animelem = 3
attr = S, HA
damage = ceil(60*fVar(10)),ceil(60*.20*fVar(10))
sparkno = s6001
sparkxy = 0,-80
guard.sparkno = s6040
hitsound = s6,3
guardsound = s10,0
animtype = hard
guardflag = M
hitflag = MAF
priority = 7, Hit
pausetime = 0, 11
guard.pausetime = 11,11
getpower = 0,0
givepower = 20,0
ground.type = high
ground.slidetime = 20
ground.hittime  = 20
guard.ctrltime  = 20
ground.velocity = -.3, 11
guard.velocity = -5
air.type = High
air.velocity = -.3, 11
airguard.velocity = -4,-3
air.hittime = 0
fall = 1
fall.recover = 0
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
forcestand = 1
kill = 0
fall.xvelocity = ifelse((enemynear,facing=facing),0.3,-0.3)
fall.yvelocity = -16.1
id = 3200
yaccel = 0.45
getpower = 0, 0
givepower = 30, 0

[State 0, end]
type = nothitby
triggerall = numtarget(3200)
trigger1 = time > 1 && movehit
value = SCA

[State 800]
type = TargetState
triggerall = numtarget(3200)
trigger1 = time > 1 && movehit
value = 3210
IgnoreHitPause = 1
Persistent = 0
id = 3200

[State 800]
type = TargetBind
triggerall = numtarget(3200)
trigger1 = time > 1 && movehit = 1
pos = 70, 0
IgnoreHitPause = 1
Persistent = 0
id = 3200

[State 800]
type = null;TargetState
triggerall = numtarget(3200)
triggerall = target(3200),Stateno = 5110 || target(3200),Stateno = 5101
triggerall = target(3200),prevstateno = 5100 || target(3200),prevstateno = 5050
trigger1 = target(3200),statetype = L
value = 3220
IgnoreHitPause = 1
Persistent = 0
id = 3200

[State 1000, ステート変更]
type = ChangeState
triggerall = numtarget(3200)
triggerall = animelemtime(4) >= 20
trigger1 = target(3200),Stateno = 3225
value = 3205

[State 1000, ステート変更]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;HHA2-2
[Statedef 3205]
type    = S
movetype= A
physics = N
poweradd= 0
velset = 0,0
anim = 3205
ctrl = 0
sprpriority = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 1000, アニメ]
type = angledraw
trigger1 = time <= 40
value = 0 - Ceil(time * 0.5)

[State 1000, アニメ]
type = angledraw
trigger1 = time >= 40
value = -20
ignorehitpause = 1

[State 0, pos]
type = posadd
trigger1 = time = [0, 40]
x = 1*ifelse(time%2=0, -1, 1)
y = 1*ifelse(time%2=0, -1, 1)
[State 0, pos]
type = posadd
trigger1 = time = (40, 48]
x = 2*ifelse(time%2=0, -1, 1)
y = 2*ifelse(time%2=0, -1, 1)
[State 0, pos]
type = posadd
trigger1 = time = (48, 60]
x = 4*ifelse(time%2=0, -1, 1)
y = 4*ifelse(time%2=0, -1, 1)

[State 0, explod]
type = playsnd
trigger1 = animelemtime(1) = 1
value = 3201, 0
[State 0, explod]
type = playsnd
trigger1 = animelemtime(2) =0
value = 6,4 

[State 0, explod]
type = playsnd
triggerall = var(7)
trigger1 = time = 1
trigger2 = time = 16
trigger3 = time = 34
trigger4 = time = 50
value = 3201, 1

[State 0, explod]
type = explod
trigger1 = time = 1
anim = 227
facing = 1
postype = p1
pos = 26,-55
sprpriority = 2
ownpal = 1
vel = 0,0
removeongethit = 1
removetime = -1
bindtime = -1
scale = 0.5, 0.5
id = 3228
[State 0, explod]
type = explod
trigger1 = time = 24
anim = 227
facing = 1
postype = p1
pos = 26,-55
sprpriority = 2
ownpal = 1
vel = 0,0
removeongethit = 1
removetime = -1
bindtime = -1
scale = 0.75, 0.75
id = 3229
angle = -20
[State 0, explod]
type = modifyexplod
triggerall = var(7)
trigger1 = 1
id = 3228
angle  = -5 * ceil(time / 16)


[State 0, explod]
type = playsnd
trigger1 = time = 12
value = 3205,0
channel = 0

[State 0, explod]
type = explod
trigger1 = animelemtime(2) = 0
anim = 3065
id = 3065
facing = 1
postype = p1
pos = 0,0
sprpriority = -1
ownpal = 1
scale = .5, .5

[State 1000, ステート変更]
type = Velset
trigger1 = animelemtime(2) = 1
x = 9
y = -18

[State 0, explod]
type = explod
trigger1 = animelemtime(2) = 0
anim = 21001
id = 21001
facing = 1
postype = p1
pos = 0,0
sprpriority = 3
ownpal = 1
bindtime = -1
removeongethit = 1
scale = .5,1
persistent = 0
ignorehitpause = 0
angle = 60

[State 1000, ステート変更]
type = Veladd
trigger1 = animelemtime(2) >= 20
y = .55

[State 200, ヒット定義]
type = HitDef
trigger1 = !var(7)
trigger1 = !movecontact
attr = A, HA
animtype  = Diagup
damage    = ceil(135*fVar(10)),ceil(135*.20*fVar(10))
guardflag = HA
pausetime = 30, 30
guard.pausetime = 10,10
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-60
hitsound   = s5,5
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 14
guard.slidetime = 10
ground.hittime  = 14
ground.velocity = -1.5, -12
air.velocity = -1.5, -12
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0*!(var(6)),0
givepower = 40,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0

[State 200, ヒット定義]
type = HitDef
trigger1 = var(7)
trigger1 = !movecontact
attr = A, HA
animtype  = Diagup
damage    = ceil(195*fVar(10)),ceil(195*.20*fVar(10))
guardflag = HA
pausetime = 30, 30
guard.pausetime = 10,10
sparkno = s6002
guard.sparkno = s6040
sparkxy = -10,-60
hitsound   = s2,2
guardsound = s10,0
priority = 4, Hit
ground.type = low
ground.slidetime = 14
guard.slidetime = 10
ground.hittime  = 14
ground.velocity = -1.5, -12
air.velocity = -1.5, -12
fall.xvelocity = ifelse((enemynear,facing=facing),1,-1)
yaccel = 0.45
getpower = 0*!(var(6)),0
givepower = 40,0
fall = 0
air.fall = 1;ifelse(EnemyNear,Movetype=H,1,0)
fall.recover = 0
down.bounce = 0
palfx.color= 32
palfx.sinadd = 42,42,10,8
palfx.mul = 364,364,128
palfx.time = 32

[State 0, explod]
type = explod
trigger1 = var(7)
trigger1 = movecontact = 1
anim = 6002
id = 6002
facing = 1
postype = p2
pos = 0,-45
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1
persistent = 0
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = var(7)
trigger1 = movecontact = 1
anim = 6030
id = 6002
facing = 1
postype = p2
pos = 0,-45
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1
persistent = 0
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = var(7)
trigger1 = movecontact = 1
anim = 6050
id = 6050
facing = 1
postype = p1
pos = 70,-85
sprpriority = 3
ownpal = 1
bindtime = 1
removeongethit = 1
scale = 1,1
persistent = 0
ignorehitpause = 1

[State 3001, Width]
type = removeexplod
trigger1 = movecontact = 1
trigger2 = !var(7)
id = 3228
[State 3001, Width]
type = removeexplod
trigger1 = movecontact = 1
trigger2 = !var(7)
id = 3229

[State 1000, アニメ]
type = angledraw
trigger1 = vel y > 0 && pos y >= 0
value = 0
time = 1

[State 1000, ステート変更]
type = ChangeState
trigger1 = vel y > 0 && pos y >= 0
value = 52


;---------------------------------------------------------------------------
;HITA_FALL (knocked up, falling)
[Statedef 3210]
type = A
movetype = H
physics = N
facep2 = 1

[State 181, nhb]
type = NotHitBy
trigger1 = Time = 0
value = SCA
time = 90

[State 181, nhb]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, anim]
type = hitvelset
trigger1 = !time
x = 1
y = 1

[State 0, anim]
type = changeanim
trigger1 = !animtime
trigger1 = anim = 5035
trigger2 = !time
trigger2 = anim != 5035
trigger2 = (anim != [5051, 5059]) && (anim != [5061, 5069])
trigger2 = anim != 5090
value = 5050

[State 0, anim]
type = changeanim
trigger1 = anim = [5050,5059]
trigger1 = vel y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 0, anim]
type = changeanim
trigger1 = anim != 5450
trigger1 = !alive
value = 5450

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 3220

;---------------------------------------------------------------------------
; HIT_BOUNCE (hit ground)
[Statedef 3220]
type    = A
movetype= H
physics = N
anim = 5100
facep2 = 1

[State 181, nhb]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1
MoveCamera = 1,0

[State 5100, 1]
type = VelSet
trigger1 = 1
x = 0

[State 2601, EnvShake]
type = EnvShake
trigger1 = !time
time = 10
ampl = 2

[State 5100, EnvShake]
type = null;FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
trigger1 = 1
value = 5100

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = null;ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5117 ;HIT_LIEDOWN

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 11]
type = null;PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = time > 21;AnimTime = 0
value = 3225

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; HIT_BOUNCE (bounce into air)
[Statedef 3225]
type    = A
movetype= H
physics = N
velset = -1.2,-4.5

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1
MoveCamera = 1,0

[State 5100, 5]
type = VelSet
trigger1 = gethitvar(fall.yvel) = 0
trigger1 = Time = 0
x = -1.2
y = -4.5

[State 5100, 5]
type = VelSet
trigger1 = gethitvar(fall.yvel) < 0
trigger1 = Time = 0
x = -1.2
y = gethitvar(fall.yvel)

[State 1000, アニメ]
type = posadd
trigger1 = gethitvar(fall.yvel) = -16.1
trigger1 = time = 1
y = -10

[State 1000, アニメ]
type = angledraw
trigger1 = gethitvar(fall.yvel) = -16.1
value = 0+(time*30)

[State 1000, アニメ]
type = changeanim2
trigger1 = !time
value = 25160

[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = 1
y = .4

[State 5040, 5] ;Recover near ground
type = SelfState
triggerall = gethitvar(fall.yvel) != -10.1
triggerall = gethitvar(fall.yvel) < 0
triggerall = time >= 15
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
trigger1 = canrecover
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 5040, 6]; Recover in mid air
type = SelfState
triggerall = gethitvar(fall.yvel) != -10.1
triggerall = gethitvar(fall.yvel) < 0
triggerall = time >= 15
triggerall = Vel Y > 0
triggerall = alive
trigger1 = canrecover
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 5101, 6] ;Hit ground
type = selfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 12
value = 5110

;===========================================================================
;画面移動停止
[Statedef 6000]
ctrl = 0
anim = 9999

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1
movecamera = -160,0

[State 0, end]
type = DestroySelf
trigger1 = (root,stateno != [3000,3010])

;---------------------------------------------------------------------------
;被ダメ時スタンド消去(スタンド被ダメ)
[Statedef 9500]
type = U
movetype = H
physics = N
ctrl = 0
anim = 9999
velset = 0,0
sprpriority = -1

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(46) = var(46)

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(46) = 0

[State 3001, Width]
type = removeexplod
trigger1 = 1
id = 1055
[State 3001, Width]
type = removeexplod
trigger1 = 1
id = 1056

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, stopsnd]
type = stopsnd
trigger1 = 1
channel = 0

[State 0, explod]
type = explod
trigger1 = !time
anim = 7201
id = 7201
pos = 0,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = !time
anim = 8201
id = 8201
pos = 0,-50
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = parentvarset
trigger1 = time = 1
var(9) = 1

[State 0, end]
type = changestate
trigger1 = HitShakeOver
value = 10000

;---------------------------------------------------------------------------
;被ダメ時スタンド消去(本体被ダメ)
[Statedef 9505]
type = U
movetype = H
physics = N
ctrl = 0
anim = 9500
velset = 0,0
sprpriority = -1

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(46) = var(46)

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(46) = 0

[State 3001, Width]
type = removeexplod
trigger1 = 1
id = 1055
[State 3001, Width]
type = removeexplod
trigger1 = 1
id = 1056

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, stopsnd]
type = stopsnd
trigger1 = !time
channel = 0

[State 0, explod]
type = explod
trigger1 = !time
anim = 7201
id = 7201
pos = 0,-60
postype = p1
sprpriority = 2
ownpal = 1
shadow = 0,0,0
scale = .555,.713
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = !time
anim = 8201
id = 8201
pos = 0,-50
postype = p1
sprpriority = 0
ownpal = 1
shadow = 0,0,0
scale = .75,.75
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = parentvarset
trigger1 = time = 1
var(9) = 1

[State 0, end]
type = changestate
trigger1 = time = 1
value = 10000

;===========================================================================
;スタンドヘルパー
[Statedef 10000]
type = U
movetype = I
physics = N
anim = 9999
ctrl = 0
velset = 0,0
sprpriority = 2

[State 5150, 8]
type = stopsnd
trigger1 = !time
channel = 7
[State 0, var]
type = removeexplod
trigger1 = !time
id = 415
[State -2,KO]
type = removeexplod
trigger1 = !time
id = 226
ignorehitpause = 1

[State -2,KO]
type = bindtoroot
trigger1 = 1
pos = 0,0
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 810
trigger2 = root,stateno = 1000
trigger3 = root,stateno = 1100
trigger4 = root,stateno = 1300
trigger5 = root,stateno = 2000
trigger6 = root,stateno = 2100
trigger7 = root,stateno = 2200
trigger8 = root,stateno = 3000
value = root,stateno + 50

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = (root,stateno = [200,220]) || (root,stateno = 410)
value = root,stateno + 5

;===========================================================================
;HITG_SHAKE
[Statedef 15000]
type = S
movetype = H
physics = N
ctrl = 0
velset = 0,0

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = helper(10000),GetHitVar(animtype) != [3,5]
value = ifelse((helper(10000),GetHitVar(groundtype) = 1),5000,5010) + helper(10000),GetHitVar(animtype)

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = helper(10000),GetHitVar(animtype) = [3,5]
;value = 5030
value = 5030

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = (helper(10000),GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + helper(10000),GetHitVar(animtype)))
value = 5047 + helper(10000),GetHitVar(animtype)

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 0, life]
type = lifeadd
trigger1 = time = 0
trigger1 = prevstateno != [5000,5099]
value = -(helper(10000),GetHitVar(damage))

[State 220, Position]
type = PosAdd
trigger1 = !helper(10000),hitshakeover
x = 1*ifelse(time%2=0,-1,1)

[State 0, state]
type = statetypeset
trigger1 = !time
trigger1 = helper(10000),GetHitVar(yvel) != 0 && helper(10000),GetHitVar(fall)
trigger2 = pos y != 0
statetype = A

[State 0, hfs]
type = HitFallSet
trigger1 = !time
value = helper(10000),GetHitVar(fall)

[State 0, end]
type = changestate
trigger1 = helper(10000),HitShakeOver
trigger1 = helper(10000),GetHitVar(yvel) = 0 && !helper(10000),GetHitVar(fall)
value = 15001

[State 0, end]
type = changestate
trigger1 = helper(10000),HitShakeOver
value = 15030

[State 0, ffb L]
type = forcefeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
waveform = square
time = 6
persistent = 0

[State 0, ffb M]
type = forcefeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
waveform = square
time = 8
ampl = 110,-1,-.3
persistent = 0

[State 0, ffb H]
type = forcefeedback
trigger1 = anim = 5002
trigger2 = anim = 5012
trigger3 = anim = 5030
waveform = square
time = 15
ampl = 140
persistent = 0

;---------------------------------------------------------------------------
;HITG_SLIDE
[Statedef 15001]
type = S
movetype = H
physics = S

[State 0, end]
type = changestate
trigger1 = !alive
value = 15030

[State 0, hitvel]
type = velset
trigger1 = !time
x = helper(10000),GetHitVar(xvel)*ifelse(facing = -1,-1,1)

[State 0, anim]
type = changeanim
trigger1 = !time
value = 5005 + helper(10000),GetHitVar(animtype) + ((helper(10000),GetHitVar(groundtype)=2)*10)

[State 0, vel]
type = velmul
trigger1 = time >= helper(10000),GetHitVar(slidetime)
x = .6

[State 0, vel]
type = velset
trigger1 = helper(10000),HitOver
x = 0

[State 0, defence]
type = defencemulset
trigger1 = helper(10000),HitOver
value = 1

[State 0, end]
type = changestate
trigger1 = helper(10000),HitOver
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;HITC_SHAKE
[Statedef 15010]
type = C
movetype = H
physics = N
velset = 0,0

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = helper(10000),GetHitVar(animtype) != [3,5]
value = 5020 + helper(10000),GetHitVar(animtype)

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = helper(10000),GetHitVar(animtype) = [3,5]
value = 5030

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = (helper(10000),GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + helper(10000),GetHitVar(animtype)))
value = 5047 + helper(10000),GetHitVar(animtype)

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 0, life]
type = lifeadd
trigger1 = time = 0
trigger1 = prevstateno != [5000,5099]
value = -(helper(10000),GetHitVar(damage))

[State 220, Position]
type = PosAdd
trigger1 = !helper(10000),hitshakeover
x = 1*ifelse(time%2=0,-1,1)

[State 0, state]
type = statetypeset
trigger1 = !time
trigger1 = helper(10000),GetHitVar(yvel) != 0 || helper(10000),GetHitVar(fall)
trigger2 = pos y != 0
statetype = A

[State 0, hfs]
type = HitFallSet
trigger1 = !time
value = helper(10000),GetHitVar(fall)

[State 0, end]
type = changestate
trigger1 = helper(10000),HitShakeOver
trigger1 = helper(10000),GetHitVar(yvel) = 0 && !helper(10000),GetHitVar(fall)
value = 15011

[State 0, end]
type = changestate
trigger1 = helper(10000),HitShakeOver
value = ifelse(alive = 0,5030,15030)

[State 0, ffb L]
type = forcefeedback
trigger1 = anim = 5020
waveform = square
time = 6
persistent = 0

[State 0, ffb M]
type = forcefeedback
trigger1 = anim = 5021
waveform = square
time = 8
ampl = 110,-1,-.3
persistent = 0

[State 0, ffb H]
type = forcefeedback
trigger1 = anim = 5022
waveform = square
time = 15
ampl = 140
persistent = 0

;---------------------------------------------------------------------------
;HITG_SLIDE
[Statedef 15011]
type = C
movetype = H
physics = C

[State 0, hitvel]
type = hitvelset
trigger1 = !time
x = 1

[State 0, anim]
type = changeanim
trigger1 = !time
value = 5025 + helper(10000),GetHitVar(animtype)

[State 0, vel]
type = velmul
trigger1 = time >= helper(10000),GetHitVar(slidetime)
x = .6

[State 0, vel]
type = velset
trigger1 = helper(10000),HitOver
x = 0

[State 0, defence]
type = defencemulset
trigger1 = helper(10000),HitOver
value = 1

[State 0, end]
type = changestate
trigger1 = helper(10000),HitOver
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;HITA_SHAKE
[Statedef 15020]
type = A
movetype = H
physics = N
velset = 0,0

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = helper(10000),GetHitVar(animtype) != [3,5]
value = ifelse((helper(10000),GetHitVar(groundtype) = 1),5000,5010) + helper(10000),GetHitVar(animtype)

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = helper(10000),GetHitVar(animtype) = [3,5]
value = 5030

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = (helper(10000),GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + helper(10000),GetHitVar(animtype)))
value = 5047 + helper(10000),GetHitVar(animtype)

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 0, life]
type = lifeadd
trigger1 = time = 0
trigger1 = prevstateno != [5000,5099]
value = -(helper(10000),GetHitVar(damage))

[State 220, Position]
type = PosAdd
trigger1 = !helper(10000),hitshakeover
x = 1*ifelse(time%2=0,-1,1)

[State 0, hfs]
type = HitFallSet
trigger1 = !time
value = helper(10000),GetHitVar(fall)

[State 0, end]
type = changestate
trigger1 = helper(10000),HitShakeOver
value = ifelse(alive = 0,5030,15030)

[State 0, ffb L]
type = forcefeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
waveform = square
time = 6
persistent = 0

[State 0, ffb M]
type = forcefeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
waveform = square
time = 8
ampl = 110,-1,-.3
persistent = 0

[State 0, ffb H]
type = forcefeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
waveform = square
time = 15
ampl = 140
persistent = 0

;---------------------------------------------------------------------------
;HITA_UP (initial going up)
[Statedef 15030]
type = A
movetype = H
physics = N
ctrl = 0
anim = 5030

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, vel]
type = velset
trigger1 = !time
x = helper(10000),GetHitVar(xvel)*ifelse(facing = -1,-1,1)
y = helper(10000),GetHitVar(yvel)-(!alive)*3

[State 0, hfs]
type = HitFallSet
trigger1 = !time
value = helper(10000),GetHitVar(fall)

[State 0, end]
type = changestate
triggerall = !helper(10000),GetHitVar(fall)
trigger1 = helper(10000),HitOver
trigger2 = vel y > 0
trigger2 = pos y >= 10
value = 15040

[State 0, end]
type = changestate
triggerall = helper(10000),GetHitVar(fall)
trigger1 = helper(10000),HitOver
trigger2 = vel y > 0
trigger2 = pos y >= 10
value = 15050

[State 0, end]
type = changestate
trigger1 = !animtime
value = 15035

;---------------------------------------------------------------------------
;HITA_UP_T (transition)
[Statedef 15035]
type = A
movetype = H
physics = N

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = SelfAnimExist(5035)
trigger1 = anim != [5051,5059]
trigger1 = anim != 5090
value = 5035

[State 0, vel]
type = veladd
trigger1 = 1
y = helper(10000),GetHitVar(yaccel)

[State 0, end]
type = changestate
triggerall = !HitFall
trigger1 = helper(10000),HitOver
trigger2 = !animtime
trigger3 = vel y > 0
trigger3 = pos y >= 10
trigger4 = !time
trigger4 = anim != 5035
value = 15040

[State 0, end]
type = changestate
triggerall = HitFall
trigger1 = helper(10000),HitOver
trigger2 = !animtime
trigger3 = vel y > 0
trigger3 = pos y >= 10
trigger4 = !time
trigger4 = anim != 5035
value = 15050

;---------------------------------------------------------------------------
;HITA_RECOV (recovering in air, not falling)
[Statedef 15040]
type = A
movetype = H
physics = N

[State 0, end]
type = changestate
trigger1 = !alive
value = 15050

[State 0, anim]
type = changeanim
trigger1 = !animtime
trigger1 = anim != 5040
trigger2 = !time
trigger2 = anim != 5035
value = 5040

[State 0, state]
type = statetypeset
trigger1 = helper(10000),HitOver
movetype = I

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, end]
type = changestate
trigger1 = vel y > 0 && pos y >= 0
value = 52

;---------------------------------------------------------------------------
;HITA_FALL (knocked up, falling)
[Statedef 15050]
type = A
movetype = H
physics = N

[State 0, anim]
type = changeanim
trigger1 = !animtime
trigger1 = anim = 5035
trigger2 = !time
trigger2 = anim != 5035
trigger2 = (anim != [5051, 5059]) && (anim != [5061, 5069])
trigger2 = anim != 5090
value = 5050

[State 0, anim]
type = changeanim
trigger1 = anim = [5050,5059]
trigger1 = vel y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, end]
type = changestate
triggerall = helper(10000),CanRecover
triggerall = alive
triggerall = vel y > 0
triggerall = pos y >= -20
trigger1 = command = "recovery"
value = 5200

[State 0, end]
type = changestate
triggerall = helper(10000),CanRecover
triggerall = alive
triggerall = vel y > -1
trigger1 = command = "recovery"
value = 5210

[State 0, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 5100

;---------------------------------------------------------------------------
;HIT_TRIP (shaking)
[Statedef 15070]
type = A
movetype = H
physics = N
velset = 0,0

[State 0, anim]
type = changeanim
trigger1 = !time
value = 5070

[State 0, life]
type = lifeadd
trigger1 = time = 0
trigger1 = prevstateno != [5000,5099]
value = -(helper(10000),GetHitVar(damage))

[State 0, hfs]
type = HitFallSet
trigger1 = !time
value = helper(10000),GetHitVar(fall)

[State 0, end]
type = changestate
trigger1 = helper(10000),HitShakeOver
value = 15071

[State 0, ffb H]
type = forcefeedback
trigger1 = !time
waveform = sinesquare
time = 12
ampl = 140

;---------------------------------------------------------------------------
;HIT_TRIP2 (fall through air)
[Statedef 15071]
type = A
movetype = H
physics = N

[State 0, vel]
type = velset
trigger1 = !time
x = helper(10000),GetHitVar(xvel)*ifelse(facing = -1,-1,1)
y = helper(10000),GetHitVar(yvel)

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, end]
type = changestate
triggerall = helper(10000),CanRecover
triggerall = alive
triggerall = vel y > 0
triggerall = pos y >= -20
trigger1 = command = "recovery"
value = 5200


[State 0, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y >= 15
value = 5110

;---------------------------------------------------------------------------
;背景演出
[Statedef 6666]
type     = S
movetype = I
physics  = S
anim     = 9999
velset   = 0,0
ctrl     = 0
sprpriority = 12

[State 3020]
type = posset
trigger1 = 1
x = (pos x-screenpos x)*facing
y = pos y-screenpos y

[State 3020]
type = BGPalFX
trigger1 = 1
time = 1
add = 0,0,0
mul = (256-(time)*10),(256-(time)*10),(256-(time)*10)
sinadd = 256,256,256,10
invertall = 0
color = 256

[State 3020, ステート変更]
type = ChangeState
trigger1 = time >= 18
value = 6667
ctrl = 0

;---------------------------------------------------------------------------
;挑発背景処理2
[Statedef 6667]
type     = S
movetype = I
physics  = S
anim     = 9999
velset   = 0,0
ctrl     = 0

[State 3020]
type = posset
trigger1 = 1
x = (pos x-screenpos x)*facing
y = pos y-screenpos y

[State 3020]
type = AssertSpecial
trigger1 = 1
flag = nofg

[State 3020]
type = BGPalFX
trigger1 = 1
time = 1
add = 0,0,0
mul = 76,76,76
sinadd = 256,256,256,10
invertall = 0
color = 256

[State 950, ステート変更]
type = ChangeState
trigger1 = time > 210
value = 6668
ctrl = 0

;---------------------------------------------------------------------------
;背景処理2
[Statedef 6668]
type     = S
movetype = I
physics  = S
anim     = 9999
velset   = 0,0
ctrl     = 0

[State 3020]
type = posset
trigger1 = 1
x = (pos x-screenpos x)*facing
y = pos y-screenpos y

[State 3020]
type = AssertSpecial
trigger1 = 1
flag = nofg

[State 3020]
type = BGPalFX
trigger1 = 1
time = 1
add = 0,0,0
mul = (76+(time*20)),(76+(time*20)),(76+(time*20))
sinadd = 256,256,256,10
invertall = 0
color = 256

[State 3020, ステート変更]
type = DestroySelf
trigger1 = time >= 9

;---------------------------------------------------------------------
;電撃ゲージ
[Statedef 8000]
anim = 9999
ctrl = 0
ownpal = 1

[State 6000, Explod]
type = Explod
trigger1 = 1
anim = 4000+(root,var(7)>0)*1
id = 4000
postype = Back
pos = 10+(teamside=2)*55,220
ownpal = 0
bindtime = -1
ignorehitpause = 1
sprpriority = 102
pausemovetime = -1
supermovetime = -1
facing = 1-(teamside=2)*2
;removetime = 1

[State 6000, Explod]
type = Explod
trigger1 = 1
anim = 4100+root,var(58)+(root,var(7)>0)*100
id = 4100
postype = Back
pos = 10,220
ownpal = 0
bindtime = -1
ignorehitpause = 1
sprpriority = 103
pausemovetime = -1
supermovetime = -1
removetime = 1-3*(root,var(7)>0)

[State 6000, Explod]
type = Explod
trigger1 = root,var(5)
anim = 4020
id = 4020
postype = Back
pos = 10,220
ownpal = 0
bindtime = -1
ignorehitpause = 1
sprpriority = 105
pausemovetime = -1
supermovetime = -1
removetime = 1

[State 0, explod]
type = explod
trigger1 = root,var(7) = 1
anim = 4300
id = 4300
pos = 23+(teamside=2)*270,204
postype = left
bindtime = -1
scale = .25,.25
ownpal = 1
sprpriority = 8
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = root,var(7) = 1
anim = 229
id = 4151
pos = 23+(teamside=2)*245,204
postype = left
bindtime = -1
scale = .25,.25
ownpal = 1
sprpriority = 103
removetime = -1
facing = 1-(teamside=2)*2
pausemovetime = 999999
supermovetime = 999999

[State 6000, Explod]
type = Explod
trigger1 = root,var(7)
trigger1 = !numexplod(4005)
trigger1 = 1||fvar(0) := 0
anim = 4005
id = 4005
postype = Back
pos = 23+(teamside=2)*28,202
ownpal = 1
bindtime = -1
ignorehitpause = 1
sprpriority = 102
pausemovetime = -1
supermovetime = -1
facing = 1-(teamside=2)*2
;removetime = 1

[State 6000, Explod]
type = varadd
trigger1 = 1
fvar(0) = 0.05

[State 6000, Explod]
type = modifyexplod
trigger1 = numexplod(4005)
id = 4005
scale = 1+fvar(0),1+fvar(0)

[State 6000, Explod]
type = removeexplod
trigger1 = !root,var(7)
id = 4151

;---------------------------------------------------------------------

;---------------------------------------------------------------------

;-------------------------------------------------------------------------
;AI起動用ヘルパー
[Statedef 50000]
anim=20000;なにも表示しないｱﾆﾒでもいいけど入れなくても全然問題ない
ctrl=0

[State 10000,間違いで本体が来たら立ちへ移行]
type=selfstate
trigger1=!ishelper
value=0

;----------------------------------------------------------------------------------
; AIフラグセット
;----------------------------------------------------------------------------------
[State 10000,プレイヤー判定]
type=varset
trigger1=command="up"&&root,command="up"
trigger2=command="down"&&root,command="down"
trigger3=command="back"&&root,command="back"
trigger4=command="fwd"&&root,command="fwd"
trigger5=command="a"&&root,command="a"
trigger6=command="b"&&root,command="b"
trigger7=command="c"&&root,command="c"
trigger8=command="x"&&root,command="x"
trigger9=command="y"&&root,command="y"
trigger10=command="z"&&root,command="z"
trigger11=command="start"&&root,command="start"
var(59)=-1

[State 10000,ﾌﾗｸﾞON]
type=varset
triggerall=var(59)!=-1
trigger1=root,command="up"
trigger2=root,command="down"
trigger3=root,command="back"
trigger4=root,command="fwd"
trigger5=root,command="a"
trigger6=root,command="b"
trigger7=root,command="c"
trigger8=root,command="x"
trigger9=root,command="y"
trigger10=root,command="z"
trigger11=root,command="start"
var(59)=1

;----------------------------------------------------------------------------------
; 暗転計測
;----------------------------------------------------------------------------------
;暗転計測
[State -1]
type = VarSet
trigger1 = root,var(59) > 0
trigger1 = enemynear,time = 1
v = 15
value = 0
ignorehitpause = 1

[State -1]
type = VarAdd
trigger1 = root,var(59)
v = 15
value = 1
ignorehitpause = 1


;===========================================================================
; ヘルパー式射撃感知
;===========================================================================
[Statedef 51000]
anim=20000;なにも表示しないｱﾆﾒでもいいけど入れなくても全然問題ない
ctrl=0

[State 10000,間違いで本体が来たら立ちへ移行]
type=selfstate
trigger1=!ishelper
value=0

[state 51000]	;ID初期値設定開始
type = varset
trigger1 = var(0) = 0
trigger1 = var(1) = 0
v = 1
value = 70+root,RoundsExisted*200

[state 30000]	;定期更新用ヘルパー射出
type=helper
trigger1 = NumHelper(51010)=0 && ishelper
trigger1 = roundstate<=2 && root,alive
helpertype=normal
name="Clear"
stateno=51010
ID=51010
pos=0,0
pausemovetime=2147483647
supermovetime=2147483647
persistent = 999

[state 30000]	;常駐ヘルパーの除外
type = varadd
trigger1 = var(0) = 0
trigger1 = var(1) > 0
trigger1 = !playerIDexist(var(1))
v = 1
value = -1

[state 30000]	;ID初期値確定フラグ
type = varadd
trigger1 = var(0) = 0
trigger1 = playerIDexist(var(1))
trigger1 = var(0):= 1
v = 1
value = 1
------------------------------ loop start -----------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)〜var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1
------------------------------- loop end ------------------------------------

[statedef 51010]
type     = A
movetype = I
physics  = N
ctrl     = 0
anim     = 20000

[State 10000,間違いで本体が来たら立ちへ移行]
type=selfstate
trigger1=!ishelper
value=0

[state 30000]
type = assertspecial
trigger1 = 1
flag = invisible
flag2 = noshadow

[state 30000]
type = Nothitby
trigger1 = 1
value = SCA

[state 30000]	;ID初期値設定開始
type = varset
trigger1 = var(30) = 0
trigger1 = var(31) = 0
v = 31
value = parent,var(1)+120+(parent,var(1)=58)*1000

[state 30000]	;既存ヘルパーの除外
type = varadd
trigger1 = var(30) = 0
trigger1 = var(31) > 0
trigger1 = !playerIDexist(var(31))
v = 31
value = -1

[state 30000]	;ID初期値確定フラグ
type = varadd
trigger1 = var(30) = 0
trigger1 = playerIDexist(var(31))
trigger1 = var(30):= 1
v = 31
value = 1

[state 30000]	;フィードバック
type = parentvarset
trigger1 = var(30) = 1
trigger1 = parent,var(1)<var(31)
v = 1
value = var(31)

[state 30000]	;消滅
type = destroyself
trigger1 = var(30) = 1
